\documentclass{amsart}

\usepackage{notes}

\title{Derived Algebraic Geometry Notes}
\date{\today}

\begin{document}

\maketitle

\section{Lecture 1, 6/26 (D. Arinkin) -- DG-Categories}

Arinkin's lectures aim to treat DG-categories as they are used in practice (without completely ignoring the foundations).
More focus will be given to the ``key parts'' of the theory than to technicalities.
We will treat foundations and geometrically-flavored examples (e.g. $\QCoh$ from a DG-perspective).

\subsection{Motivation}

In classical algebra and algebraic geometry, we like to consider modules over a ring.
We pass to resolutions to get things which behave better from a homological perspective.
This leads to considering derived categories.
What kind of objects are derived categories?

\begin{enumerate}
\item Derived categories are \emph{triangulated categories}.
This means that they are equipped with a notion of \emph{distinguished triangles} (also called \emph{exact triangles}), which capture the notion of mapping cones.
However, this structure can be poorly behaved.
\item Derived categories are \emph{DG-categories}, or (mostly equivalently) \emph{stable $\infty$-categories}.
Arinkin considers the DG category perspective to be more concrete.
Using this perspective changes something fundamental about the category (what we obtain is more complex than a typical $1$-category).
However, DG categories can be more robust, especially when considering the ``category of DG-categories.''
\end{enumerate}

\subsection{DG-categories and examples}

Fix a field $k$ (often we can get away with working over a commutative ring, but this may require more caution).
Let $\Csf(k)$ be the monoidal category of complexes of $k$-vector spaces, equipped with the tensor product $\otimes_k$ as monoidal structure.

\begin{dfn}
A \emph{DG-category} $\Asf$ consists of 
\begin{enumerate}
	\item A collection of objects $\Ob \Asf$
	\item For all $x, y \in \Ob \Asf$, a chain complex of morphisms $\Hom_{\Asf}(x, y) \in \Ob \Csf(k)$
	\item For all $x, y, z \in \Ob \Asf$, a composition law $\circ: \Hom_{\Asf}(x, y) \otimes \Hom_{\Asf}(y, z) \to \Hom_{\Asf}(x, z)$
\end{enumerate}
such that
\begin{enumerate}
	\item Composition is associative.
	\item Composition is unital: for all $x \in \Asf$, there exists a degree-zero cycle $\onebb_x \in \Hom_{\Asf}(x, x)$ (so $d(\onebb_x) = 0$) such that $\onebb_x \circ f = f$ and $g \circ \onebb_x = g$ for all $f, g$.
\end{enumerate}
\end{dfn}

\begin{ex}
We can consider the case where $\Hom(x, y)$ is always concentrated in degree zero.
This recovers the notion of a $k$-linear category.
\end{ex}

\begin{ex}
Let $R$ be a $k$-algebra.
We can turn $C(R)$ (the category of complexes of $R$-modules) into a DG-category by setting
\[
\Hom(M^\bullet, N^\bullet)^p = \prod_{q} \Hom_R(M^p, N^{p+q})
\]
with differential $d_{\Hom} = [d, -]$.
It is crucial here that we use the product rather than the direct sum (otherwise we run into issues when the complexes are not bounded).
\end{ex}

We can also construct some examples where the $\Hom$-complexes are standard complexes computing $\Ext$ groups.
This ties into the classical perspective on homological algebra, where derived functors are computed using explicit resolutions.

\begin{ex}
Let $R$ be a $k$-algebra.
We can define a DG-category $\Asf$ with $\Ob \Asf$ being $R$-modules and $\Hom_{\Asf}(M, N)$ being the standard complex computing $\Ext^\bullet(M, N)$ via the bar resolution.
We will not spell out the details here because this is not our emphasis.
\end{ex}

\begin{ex}
Let $k = \CC$, and fix a complex manifold $X$.
We can define a DG-category $\Asf$ with objects being holomorphic vector bundles on $X$ and $\Hom_{\Asf}(E, F)$ given by the Dolbeault complex
\[
\begin{tikzcd}
0 \rar & \Cc^\infty(E^* \otimes F) \rar["\ol{\partial}"] & \Omega^{0,1}(E^* \otimes F) \rar["\ol{\partial}"] & \dots
\end{tikzcd}
\]
\end{ex}

As stated above, our main examples of interest are really \emph{derived categories}.
We still need to build up some more definitions to get a good understanding of these.

\subsection{DG-Functors}

One would like to have a good notion of functors between DG-categories.
It turns out that the na\"ive definition of DG-functors works (and does not require homotopical corrections).

\begin{dfn}
A DG-functor $F: \Asf \to \Bsf$ consists of:
\begin{enumerate}
\item An assignment $F: \Ob \Asf \to \Ob \Bsf$
\item For every $x, y \in \Ob \Asf$, a chain map $\Hom_\Asf(x, y) \to \Hom_\Bsf(F(x), F(y))$
\end{enumerate}
which preserves identities and composition.
\end{dfn}

\begin{rmk}
While the obvious notion of a DG-functor works fine, subtleties arise when one considers the notion of equivalence.

One can first define a notion of \emph{strict equivalence}.
A DG-functor $F: \Asf \to \Bsf$ is a strict equivalence if
\begin{enumerate}
\item $F$ is strictly fully faithful: for all $x, y \in \Ob \Asf$, $\Hom_\Asf(x, y) \to \Hom_\Bsf(F(x), F(y))$ is an isomorphism.
\item $F$ is strictly essentially surjective: for all $y \in \Ob \Bsf$, there exists $x \in \Ob \Asf$ such that $F(x)$ is isomorphic to $y$.
\end{enumerate}
As one knows from the study of derived categories, the notion of ``isomorphism'' here is often too strong - one would rather consider quasi-isomorphisms or other weaker notions.

A better notion is that of \emph{quasi-equivalence}.
A DG-functor $F: \Asf \to \Bsf$ is a quasi-equivalence if
\begin{enumerate}
	\item $F$ is quasi-fully faithful: for all $x, y \in \Ob \Asf$, $\Hom_\Asf(x, y) \to \Hom_\Bsf(F(x), F(y))$ is a quasi-isomorphism.
	\item $F$ is quasi-essentially surjective: for all $y \in \Ob \Bsf$, there exists $x \in \Ob \Asf$ such that there exist maps $F(x) \to y$ and $y \to F(x)$ with the both compositions $F(x) \to F(x)$ and $y \to y$ homotopic to the relevant identities.
\end{enumerate}
\end{rmk}

\begin{exer}
For a DG-category $\Asf$, let $\Ho \Asf$ be the \emph{homotopy category} of $\Asf$, i.e.\ the $1$-category with the same objects as $\Asf$ and morphisms given by $\Hom_{\Ho \Asf}(x, y) = H^0(\Hom_{\Asf}(x, y))$.
\begin{enumerate}
\item Check that $\Ho \Asf$ is a well-defined $1$-category. (This uses the fact that the functor $H^0$ is lax monoidal.)
\item Show that a DG-functor $F: \Asf \to \Bsf$ is quasi-essentially surjective if and only if $\Ho F: \Ho \Asf \to \Ho \Bsf$ is essentially surjective.
\end{enumerate}
\end{exer}

\section{Lecture 2, 6/26 (B. Antieau) -- Motivation and the Functor of Points}

Antieau's lectures aim to treat the intuition and geometry behind DAG, without getting lost in the details.

\subsection{``Bird's Eye View'' and Examples}

We begin with a classical proposal of Serre.
Let $X$ be a regular variety, with $W, Y \subset X$ and $W \subset Y$ being a finite set of points.
We would like to count $W \cap Y$.
In the case of transverse intersections, this is easy, but in general we have to count with multiplicity.
If we move $W$ and $Y$ around, this count with multiplicity should not change.
Serre proposed that the intersection multiplicity at a point $z \in W \cap Y$ is given by
\[
\sum_{i \geq 0} (-1)^i \length_{k(z)} \Tor^i(\Oc(X)_z)(\Oc(X)_z / I_z, \Oc(Y) / I_z).
\]
It is not immediately obvious why this is a reasonable definition, but it turns out to work well in good cases.
One can show that (when working over a field) this intersection multiplicity is nonnegative.

\begin{ex}
Consider the intersection in $\AA^2$ of the curve $W = \{ y = x^2 \}$ with the $x$-axis $Y$.
One can compute that the intersection multiplicity is $2$ (coming exclusively from $\Tor^0$).
This makes sense: if we move the curves around, then we will get two actual intersection points.

For the Tor computation, we note $\Oc(W) = k[x, y] / (y - x^2)$ and $\Oc(Y) = k[x, y] / (y)$.
Then $\Oc(Y) \otimes_{\Oc(X)} \Oc(W) = k[x] / (x^2)$, and there are no higher Tor's.
This can be interpreted geometrically using the common tangent vector to $W$ and $Y$ at the origin.
\end{ex}

\begin{ex}
For the first historical example with higher $\Tor$s, we work in $\AA^4 = \Spec k[w, x, y, z]$.
Let $Y$ be the union of planes $P_1 \cup P_2 = \{ x = y = 0 \} \cup \{ z = w = 0 \}$, and let $W$ be the plane $\{ x = z, y = w\}$.
Then the $\Tor_0$ term is $3$-dimensional, but the ``correct'' intersection multiplicity should be $2$ (if we perturb $W$, it should meet each plane $P_i$ in a single point).
Thus we must use the $\Tor^1$ term to correct our intersection multiplicity.
\end{ex}

The main idea of derived algebraic geometry is that we should understand intersection multiplicities geometrically by replacing $\Oc(Y) \otimes_{\Oc(X)} \Oc(W)$ by a \emph{derived commutative ring} $\Oc(Y) \otimes_{\Oc(X)}^\Lbf \Oc(W)$.
In the affine case, ``$\Spec$'' of this should give the \emph{derived intersection} $Y \cap^\Lbf W = Y \times_X^\Lbf W$.
We will of course need to make sense of what this means.

Derived algebraic geometry also gives rise to interesting self-intersections, which we can use to understand what derived commutative rings and schemes should be.

\begin{ex}
Consider $\{0\} \subset \AA^1$, viewed as $\Spec$ of $k = k[x] / (x)$.
The classical self-intersection is $\{0\} \cap \{0\} = \{0\}$.
Note that this is not what we'd get if we moved the points (since two general points in $\AA^1$ do not meet).

For the derived self-intersection, we have 
\[
\pi_i(k \otimes_{k[x]}^\Lbf k) = \begin{cases}
	k & i = 0 \\
	k & i = 1 \\
	0 & i > 0.
\end{cases}
\]
For derived commutative rings, we say $\pi_i = H_i = H^{-i}$.
We can think of elements of $\pi_i$ for $i > 0$ as higher nilpotents / ``fuzz'' (in addition to the nilpotents that appear in $\pi_0$ when working scheme-theoretically).

Recall that in classical geometry, for commutative $k$-algebras $R$ and $S$, we have
\[
\Hom_{\Sch_k}(\Spec S, \Spec R) = \Hom_{\CAlg_k}(R, S).
\]
Note that the right hand side of this is a set.
For our example, we expect to have
\[
\Hom_{\dSch_k}(\{0\} \cap^\Lbf \{0\}, \AA^1) = \Oc(\{0\} \cap^\Lbf \{0\}) = k \otimes_{k[x]}^\Lbf k,
\]
which should be a ``space'' with $\pi_0 = \pi_1 = k$ (not just a set).

Furthermore, instead of considering abelian categories of quasicoherent sheaves on $\{0\} \cap^\Lbf \{0\}$, it makes much more sense to consider derived categories of quasicoherent sheaves.
One can still make sense of the abelian categories, but they don't see the interesting higher homotopy groups.
\end{ex}

Through considering this and other examples, we end up with some ideas about what ``derived replacements'' of concepts in classical algebraic geometry should be.

\begin{center}
	\begin{tabular}{c|c}
		Classical AG & Derived AG \\ \hline
		Commutative rings $R$ & Derived commutative rings $R$ \\
		Affine schemes $\Spec R$ & Derived affine schemes $\Spec R$ \\
		Sheaves of sets & Sheaves of homotopy types \\
		Abelian categories $\QCoh(X)$ & DG-categories (or stable $\infty$-categories) $\Dsf_qc(X)$
	\end{tabular}
\end{center}

\subsection{Presheaves and Yoneda}

Let $\Csf$ be a category.
Write $\Psh(\Csf)^\heartsuit = \Fun(\Csf\op, \Set)$ for the \emph{category of presheaves of sets} on $\Csf$.
Objects of this category are functors $F: \Csf\op \to \Set$, and morphisms are natural transformations of functors.

There is a natural \emph{Yoneda embedding} $h: \Csf \to \Psh(\Csf)^\heartsuit$, defined by $h(X) = h_X$, where $h_X(Y) = \Hom_\Csf(Y, X)$.

\begin{lem}[Yoneda]
\,
\begin{enumerate}
	\item The Yoneda embedding $h: \Csf \to \Psh(\Csf)^\heartsuit$ is fully faithful, i.e.\ $\Hom_\Csf(X, Y) \cong \Hom_{\Psh(\Csf)^\heartsuit}(h_X, h_Y)$ naturally in $X, Y$.
	\item For any $F \in \Psh(\Csf)^\heartsuit$, there is a natural isomorphism $F(X) \cong \Hom_{\Psh(\Csf)^\heartsuit}(h_X, F)$.
\end{enumerate}
\end{lem}

\begin{proof}
The first statement follows from the second by taking $F = h_Y$ in the second.
To prove the second statement, we can construct explicit natural isomorphisms as follows.
To get $\Hom_{\Psh(\Csf)^\heartsuit}(h_X, F) \to F(X)$, start with $f: h_X \to F$, and evaluate $f$ on $\id_X \in h_X(X)$ to get an element of $F(X)$.
Conversely, given $g \in F(X)$, construct a natural fransformation $h_X \to F$ by sending $a \in h_X(Y) = \Hom_\Csf(Y, X)$ to $F(a)(g) \in F(Y)$.
One can check that these are both natural and mutually inverse. 
\end{proof}

\begin{ex}
Let $\Delta^1$ be the category with two objects $0, 1$ and one non-identity morphism $0 \to 1$.
Then $\Psh(\Delta^1)^\heartsuit$ is the category of arrows in $\Set$.
The functor $h_0$ corresponds to the arrow $\emptyset \to *$, and the functor $h_1$ corresponds to the arrow $* \to *$.
\end{ex}

\subsection{Topologies and sheaves}

\begin{dfn}
A map $f: R \to S$ in $\CAlg_k$ is \emph{flat} if the functor $S \otimes_R (-): \Mod_R \to \Mod_S$ is exact.
We say that $f$ is furthermore \emph{faithfully flat} if $S \otimes_R (-)$ is conservative (i.e.\ for $g: M \to N$, if $S \otimes g: S \otimes_R M \to S \otimes_R N$ is an isomorphism, then $g$ must have already been an isomorphism).
\end{dfn}

\begin{ex}
\,
\begin{enumerate}
	\item For any $R$, the map $R \to 0$ is flat but not faithfully flat.
	\item The map $\ZZ \to \QQ$ is flat but not faithfully flat.
	\item Any field extension $K \to L$ is faithfully flat.
	\item For $f, g \in R$ with $(f, g) = 1$, the map $R \to R[f\inv] \times R[g\inv]$ is faithfully flat.
	Note that this gives a Zariski cover of $\Spec R$.
\end{enumerate}
\end{ex}

Let $\Aff_k = \CAlg\op$ be the \emph{category of affine $k$-schemes}.
We will define some topologies on $\Aff_k$.

\begin{dfn}
\,
\begin{enumerate}
	\item The \emph{fpqc topology} on $\Aff_k$ has coverings of $\Spec R$ generated by those of the form $\{ \Spec S_i \to \Spec R\}_{i \in I}$ where $I$ is finite, each $R \to S_i$ is flat, and $R \to \prod_i S_i$ is faithfully flat.\footnote{Note the ``generated by'' -- we allow infinite covers.}
	\item For the \emph{fppf topology}, we require furthermore that each $S_i$ is of finite presentation over $R$ (i.e.\ $S_i = R[x_1, \dots, x_p] / (f_1, \dots, f_q)$ for some $x_i$ and $f_j$.)
	\item For the \emph{\'etale topology}, we require furthermore that each $S_i$ is \'etale over $R$ (i.e.\ $S_i$ is smooth over $R$ with $\Omega^1_{S_i/R} = 0$).
	\item For the \emph{Zariski topology}, we require furthermore that each $S_i$ is of the form $R[f\inv]$ for some $f \in R$.
\end{enumerate}
\end{dfn}

\section{Lecture 3, 6/27 (B. Antieau) -- More on Functor of Points, Introduction to $\infty$-categories}

\subsection{Topologies and sheaves, continued}

Let $\tau$ be one of the topologies on $\Aff_k$ mentioned last time.
Define a full subcategory $\Sh_\tau(\Aff_k)^\heartsuit \subset \Psh(\Aff_k)^\heartsuit$, the \emph{category of sheaves for the $\tau$-topology}, by declaring $\Fc \in \Sh_\tau(\Aff_k)^\heartsuit$ if and only if for all $\tau$-covers $\Spec S \to \Spec R$, the natural diagram
\[
	\Fc(R) \to \Fc(S) \rightrightarrows \Fc(S \otimes_R S)
\]
is an equalizer diagram.
In more pedestrian language, $\Fc(R)$ is the subset of elements $x \in \Fc(S)$ such that the two images of $x$ in $\Fc(S \otimes_R S)$ agree.
One should think of $\Spec S$ as a collection of opens of $\Spec R$.
From this perspective, $\Spec S \otimes_R S$ is the collection of intersections of the opens appearing in $\Spec S$.

There was a question about whether we need to impose a condition on compatibility with products to account for the case of covers of the form $\{ \Spec S_i \to \Spec R \}_{i \in I}$.
Antieau claimed that this condition is superfluous and that it would be a good exercise to deduce this compatibility from the definition of $\Sh_\tau(\Aff_k)^\heartsuit$.

\begin{thm}[Grothendieck]
The presheaf $\Spec R \mapsto R$ is a sheaf for the $\tau$-topologies.
\end{thm}

\begin{proof}
This follows from faithfully flat descent, i.e.\ the exactness of
\[
R \to S \to S \otimes_R S
\]
for a faithfully flat ring map $R \to S$.
\end{proof}

\begin{exer}
We can view $\Spec R$ as a presheaf on $\Aff_k$ via $(\Spec R)(\Spec S) = \Hom_{\CAlg_k}(R, S)$.
Show that this is a $\tau$-sheaf.
Thus the topologies $\tau$ mentioned above are subcanonical (i.e.\ representable presheaves are sheaves.
\end{exer}

The inclusion $\Sh_\tau(\Aff_k)^\heartsuit \subset \Psh(\Aff_k)^\heartsuit$ admits a left adjoint, known as $\tau$-sheafification and written $a_\tau$.
Here we are secretly ignoring some potential set-theoretic issues (which can be dealt with systematically using Grothendieck universes).

\begin{rmk}
	If $\Dsf \to \Psh(\Csf)^\heartsuit$ is a fully faithful map of categories that admits a left adjoint (which satisfies the mild set-theoretic hypothesis of being $\kappa$-accessible for some $\kappa$), we call $\Dsf$ a \emph{presentable category}.
	If furthermore the left adjoint $\Psh(\Csf)^\heartsuit \to \Dsf$ preserves finite limits, we call $\Dsf$ a \emph{topos}.
	Topoi generally behave like categories of sheaves.
\end{rmk}

\subsection{Representable morphisms}

For a scheme $Z$, we get a $\tau$-sheaf $h_Z \in \Sh_\tau(\Aff_k)^\heartsuit$ via $h_Z(\Spec R) = \Hom_{\Sch_k}(\Spec R, Z)$.

\begin{thm}
	The functor $h_{(-)}: \Sch_k \to \Sh_\tau(\Aff_k)^\heartsuit$ is fully faithful.
\end{thm}

Thus we may identify $h_Z$ with $Z$ for any scheme $Z$.
Note that this is not quite the Yoneda lemma (we are viewing a scheme as a $\tau$-sheaf on affine schemes, not all schemes), but it is closely related.
The key idea is that schemes are constructed from gluing affine schemes, and meditating on this enough yields a proof of the above theorem.

\begin{dfn}
	A morphism $X \to Y$ in $\Sh_\tau(\Aff_k)^\heartsuit$ is \emph{representable in schemes} if, for all $\Spec R \to Y$, the fiber product $P = X \times_Y \Spec R$ is representable (i.e.\ isomorphic to $h_Z$ for some scheme $Z$).
\end{dfn}

We can generalize standard geometric properties of schemes to properties of representable morphisms by imposing said properties on base changes to (affine) schemes.
For example:

\begin{dfn}
	A morphism of $\tau$-sheaves $X \to Y$ is open if it is representable in schemes and for all $\Spec R \to Y$, the base change $X \times_Y \Spec R \to \Spec R$ is a disjoint union of open embeddings of schemes.
\end{dfn}

The terminology here is a bit lazy and is designed primarily to make the next theorem straightforward.
We would like to characterize the essential image of the embedding $h_{(-)}: \Sch_k \to \Sh_\tau(\Aff_k)^\heartsuit$.

\begin{thm}
A $\tau$-sheaf $X$ is isomorphic to $h_Z$ for some $Z \in \Sch_k$ if and only if it admits an open surjective map $\coprod_i \Spec S_i \to X$.
\end{thm}

\subsection{Examples}

Here we will define some schemes by their functors of points.

\begin{ex}
	Let $X \in \Sh_\tau(\Aff_k)^\heartsuit$ be given by
	\[
		X(R) = \{ (x, y) \in R^2 \, | \, x^2 + y^2 = 1 \}.
	\]
	Then we can represent $X$ by $\Spec k[x, y] / (x^2 + y^2 - 1)$.
\end{ex}

\begin{ex}
	The additive group $\GG_a$ is given by $\GG_a(R) = R$.
	In terms of coordinate rings, we have $\GG_a = \Spec k[x]$.
\end{ex}

\begin{ex}
	The multiplicative group $\GG_m$ is given by $\GG_m(R) = R^\times$.
	In terms of coordinate rings, we have $\GG_m = \Spec k[x, x\inv]$.
\end{ex}

\begin{ex}
	We can na\"ively try to define $X = \PP^n_k$ via the functor of points $X(R) = (R^{n+1} \setminus \{ 0 \}) / R^\times$.
	However, this fails -- the $X$ we define here is not even a functor!
\end{ex}

\begin{ex}
	The correct definition of $\PP^n_k$ is via the functor of points
	\[
		\PP^n_k(R) = \{ (P, q) \, | \, P \textrm{a rank $1$ projective module over $R$}, q: R^{n+1} \twoheadrightarrow P \}.
	\]
\end{ex}

\begin{exer}
	Use the theorem of the preceding section to show that $\PP^n_k$ is a scheme.
\end{exer}

\subsection{$\infty$-categories}

Let's move on to a new topic.
As in Arinkin's lectures, we would like to replace $1$-categories with categories ``enriched in spaces up to weak homotopy equivalence''.
Taking this literally (i.e.\ using actual topological spaces) turns out to be hard to work with, so we will instead use the formalism of quasi-categories.

Let $\Delta$, the \emph{simplex category}, be the category of nonempty finite totally ordered sets and order-preserving functors.
Every object of $\Delta$ is isomorphic to some $[n] = \{ 0 \leq 1 \leq \dots \leq n \}$ for some $n \geq 0$.
We are particularly interested in the \emph{face maps} $\partial^i: [n] \to [n+1]$ for $i = 0, \dots, n+1$ (with $\partial^i$ being the injective map missing the element $i \in [n+1]$ and otherwise bijective) and the \emph{degeneracy maps} $s^i: [n] \to [n-1]$ for $i = 0, \dots, n+1$ (with $s^i$ being the surjective map hitting the element $i$ twice and otherwise bijective).

A \emph{simplicial set} is a presheaf on $\Delta$, and we write the category of simplicial sets as $\sSet = \Fun(\Delta\op, \Set) = \Psh(\Delta)^\heartsuit)$.
More generally, the category of simplicial objects in a category $\Csf$ is $\ssf\Csf = \Fun(\Delta\op, \Csf)$.
Dually, the category of cosimplicial objects in $\Csf$ is $\csf\Csf = \Fun(\Delta, \Csf)$.

\begin{ex}
	Let $X$ be a topological space.
	We can define the singular simplicial set of $X$ as $\Sing_\bullet(X) = \Hom_{\Top}(\Delta^\bullet_{\mathrm{top}}, X)$.
	That is, $\Sing_n(X) = \Hom_{\Top}(\Delta^n_{\mathrm{top}}, X)$ where 
	\[
		\Delta^n_{\mathrm{top}} = \{ (x_0, \dots, x_n) \in \RR^{n+1} \, | \, x_i \geq 0 \forall i, \textrm{ and } \sum_{i} x_i = 1\}.
	\]
	Note that $\Delta^\bullet_{\mathrm{top}} \in \csf\Top$.
	Applying the free abelian group functor $\ZZ[-]: \Set \to \Ab$ to $\Sing^\bullet(X)$ gives a simplicial abelian group from $X$.
	Via the Dold-Kan correspondence, this corresponds to a connective chain complex $C_\bullet(X, \ZZ)$ which computes $H_\bullet(X, \ZZ)$.
\end{ex}

\begin{ex}
	Let $\Csf$ be a (small) category.
	We can define a simplicial set $\Nsf_\bullet \Csf$, the \emph{nerve of $\Csf$}, by setting $\Nsf_n(\Csf) = \Hom_{\Cat}([n], \Csf)$, where we view $[n]$ as the category $(0 \to 1 \to \dots \to n)$.
	Here $\Nsf_0(\Csf) = \Ob \Csf$, $\Nsf_1(\Csf)$ is the set of all morphisms in $\Csf$, and $\Nsf_2(\Csf)$ is the set of all composable pairs of morphisms in $\Csf$.
\end{ex}

\begin{cons}
	Consider the left Kan extension $|-|: \sSet \to \Top$ in
	\[
		\begin{tikzcd}
			\Delta \arrow[r, "\Delta^\bullet_{\mathrm{top}}"] \arrow[d, "{[n]} \mapsto \Delta^n"] & \mathrm{Top} \\
	\sSet \arrow[ur, dashed, "|-|"]
		\end{tikzcd}
	\]
	We call this functor \emph{geometric realization}.
\end{cons}

\begin{ex}
	Here $|\Delta^n| = \Delta^n_{\mathrm{top}}$.
	Let $\partial \Delta^n$ be the subsimplicial set of $\Delta^n$ missing the unique nondegenerate $n$-simplex.
	Then $|\partial \Delta^n| \simeq S^{n-1}$.
\end{ex}

We define the horn $\Lambda_i^n$ as the subsimplicial set of $\Delta^n$ missing the $i$th face of $\Delta^n$ (i.e.\ the face opposite to the $i$th vertex).

\begin{exer}
	Consider the problem of extending a map of simplicial set $\Lambda_i^n \to X_\bullet$ along the inclusion $\Lambda_i^n \to \Delta^n$.
	\begin{enumerate}
		\item For a topological space $Y$ and $X_\bullet = \Sing_\bullet(Y)$, show that lifts exist for all horns $\Lambda_i^n$.
		Stated differently, $Y$ is a \emph{Kan complex} or \emph{$\infty$-groupoid}.
		This is easiest understood using the corresponding diagrams
		\[
			\begin{tikzcd}
				\Lambda^n_i \rar \dar & \Sing_\bullet(Y) \dar \\
				\Delta^n \rar & \pt
			\end{tikzcd}
			\Leftrightarrow
			\begin{tikzcd}
				{|\Lambda^n_i|} \rar \dar & Y \dar \\
				\Delta^n_{\mathrm{top}} \rar & \pt
			\end{tikzcd}
		\]
		\item For a category $\Csf$ and $X_\bullet = \Nsf_\bullet \Csf$, show that extensions exist for all inner horns (i.e.\ when $0 < i < n$).
	\end{enumerate}
\end{exer}

\begin{dfn}
	An $\infty$-category or quasi-category is a \emph{weak Kan complex}, i.e.\ a simplicial set $X_\bullet$ such that any map $\Lambda_i^n \to X_\bullet$ (with $0 < i < n$) extends to a map $\Delta^n \to X_\bullet$.
\end{dfn}

Thus singular simplicial sets and nerves are both examples of $\infty$-categories.

Studying $\infty$-categories will allow us to achieve our goal of unifying homotopy theory and category theory.
Namely, there is a model structure on $\sSet$ such that if we invert weak equivalences, we get a category (Quillen?)-equivalent to $\Top$ with weak homotopy equivalences inverted.
There was some discussion of ``Joyal model structures'' but I missed it.

\section{Lecture 4, 6/27 (D. Arinkin) - Derived Categories}

Recall what we did last time.
If $\Asf$ is a DG-category, then $\Hom_\Asf(x, y)$ is a chain complex for all $x, y \in \Ob \Asf$.
DG-functors are defined ``na\"ively, but (quasi-)equivalences are not.
A quasi-equivalence is required to be quasi-fully faithful and quasi-essentially surjective.
This comes from the natural weakening of the notion of ``inverses,'' i.e.\ requiring that quasi-equivalences are only invertible ``up to homotopy.''

\subsection{Construction of Derived Categories -- Strategy}

For a (DG-)ring $R$, we would like to move from the DG-category $\Csf(R)$ of complexes of $R$-modules to the corresponding derived category $\Dsf(R)$.

\begin{ex}
	A DG-category with a single object $x$ can be identified with a DG-ring $R$, namely $R = \End(x)$.
\end{ex}

There are two well-known approaches to constructing $\Dsf(R)$.

\begin{enumerate}
	\item One approach is via localization: we invert quasi-isomorphisms in $\Csf(R)$.
		To make this work in the DG-context, one can see Drinfeld's paper ``DG-quotients of DG-categories.''
		It may be surprising that we use quotients to construct localizations.
		In fact, when working with DG-categories, localizations and quotients are effectively equivalent: inverting a morphism $f$ is the same as killing the object $\cone(f)$.
	\item Another approach is to resolve all objects of $\Csf(R)$.
		This is analogous to choosing good representatives in each equivalence class in the quotient.
\end{enumerate}

We will focus on the latter approach (using resolutions) for now.

\subsection{The classical viewpoint}

\begin{ex}
	The bounded below derived category $\Dsf^-(R)$ is equivalent to the (DG-)category $\Csf^-(R)^{\mathrm{proj}}$ of bounded above complexes of projective modules.
	If one likes, one could take this as a definition of $\Dsf^-(R)$.
	One could also prove this using a different definition of $\Dsf^-(R)$ by showing that the notions of equivalence in $\Dsf^-(R)$and $\Csf^-(R)^{\mathrm{proj}}$ match up.
\end{ex}

An analogous approach (using injective modules) works for $\Dsf^+(R)$.
It takes some more work to find an analogous description of $\Dsf(R)$, but this can still be treated classically.

The classical idea (due to Spaltenstein) says that we should resolve an unbounded complex
\[
	\begin{tikzcd}
		\dots \rar & A^{-1} \rar & A^0 \rar & A^1 \rar & \dots
	\end{tikzcd}
\]
by truncating $A^\bullet$ and resolving the truncations.
Consider first the clean truncation $\tau_{\leq 0} A^\bullet$, and resolve by a complex of projectives:
\[
	\begin{tikzcd}
		\dots \rar & A^{-1} \rar & A^0 \rar & d(A^0) \rar & 0 \rar & \dots \\
		\dots \rar & P_{(0)}^{-1} \rar \uar & P_{(0)}^0 \rar \uar & P_{(0)}^1 \rar \uar & 0 \rar \uar & \dots.
	\end{tikzcd}
\]
We can come up with a different resolution for the clean truncation $\tau_{\leq 1} A^\bullet$:
\[
	\begin{tikzcd}
		\dots \rar & A^{-1} \rar & A^0 \rar & A^1 \rar & d(A^1) \rar & 0 \rar & \dots \\
		\dots \rar & P_{(1)}^{-1} \rar \uar & P_{(1)}^0 \rar \uar & P_{(1)}^1 \rar \uar & P_{(1)}^2 \rar \uar & 0 \rar \uar & \dots.
	\end{tikzcd}
\]
Since these are resolutions and we have a map $\tau_{\leq 0} A^\bullet \to \tau_{\leq 1} A^\bullet$, we obtain a map $P_{(0)}^\bullet \to P_{(1)}^\bullet$.
Continuing inductively, we get a sequence of bounded above complexes of projectives $P_{(i)}^\bullet$ with maps $P_{(i)}^\bullet \to P_{(i+1)}^\bullet$.
Using mapping cylinders, we can assume that each $P_{(i)}^\bullet \to P_{(i+1)}^\bullet$ is injective (at the chain level), so let $P^\bullet = \cup_i P_{(i)}^\bullet$.
Thus we obtain an unbounded complex of projectives $P^\bullet$ with a quasi-isomorphism $P^\bullet \to A^\bullet$.

The key property of $P^\bullet$ that we will be using is \emph{$K$-projectivity}, also called \emph{homological projectivity}.
This property states that for any acyclic complex $C^\bullet$, the $\Hom$-complex $\Hom(P^\bullet, C^\bullet)$ is acyclic.
One can show that $\Dsf(R)$ is equivalent to the category of $K$-projective complexes in $\Csf(R)$.
In the DG-context, one either takes this as a definition or proves the equivalence (starting from the definition of $\Dsf(R)$ as a quotient mentioned earlier).

\begin{rmk}
	Note that we could have replaced ``projective'' by ``free'' throughout, and nothing would have changed.
\end{rmk}

Note that homotopical projectivity does not follow from the fact that $P^\bullet$ is a complex of projectives (in the unbounded case).

\begin{ex}
	Take $R$ = $\ZZ / 4 \ZZ$, and let $P^\bullet$ be the complex of projectives defined by $P^i = R$ for all $i$, with all differentials given by multiplication by $2$.
	For $C^\bullet = P^\bullet$ (which is acyclic), we can compute that $\Hom(P^\bullet, C^\bullet)$ is not acyclic (due to the presence of the identity map, which in this case is not homotopic to $0$).
	If one wants to work over a field, one could instead use $k[x] / (x^2)$ or something similar.
	This example leads to much theory (related to categories of singularities, matrix factorizations, Eisenbud periodicity, etc.).
	The problem here is related to $R$ not being regular.
\end{ex}

Note however that bounded above complexes of projectives are homotopically projective.
To prove that our original $P^\bullet$ is homotopically projective, we would want to reduce to the case of bounded above complexes of projectives.

\subsection{Semi-free modules}

We will now study how to make this work in the DG-context.
Let $R$ be a DG-ring.
The term ``module'' will now be used for a (potentially unbounded) complex of $R$-modules. 

\begin{dfn}
	A \emph{free module} is a chain complex of the form $\oplus_{n \in \ZZ} R^{I_n}[n]$.
	A \emph{semi-free module} is a chain complex $M^\bullet = \cup_{i \geq 0} M_i^\bullet$ such that $M_{i+1} / M_i$ is free for all $i$.
	In this case, the differential satisfies $d(M_{i+1}) \subset M_i$, i.e.\ is ``strictly upper triangular.''
\end{dfn}

\begin{ex}
	If $R$ is a classical ring, a bounded above complex of free modules
	\[
		\begin{tikzcd}
			\dots \rar & F^{-2} \rar & F^{-1} \rar & F^0 \rar & 0 \rar & \dots
		\end{tikzcd}
	\]
	is semi-free.\footnote{If $R$ is not classical, this complex doesn't really make sense.}
\end{ex}

\begin{ex}
	More generally (but still for $R$ classical), consider an increasing union
	\[
		\begin{tikzcd}
			\dots \rar & F_{(0)}^{-2} \rar \dar[hookrightarrow] & F_{(0)}^{-1} \rar \dar[hookrightarrow] & F_{(0)}^0 \rar \dar[hookrightarrow] & 0 \rar \dar[hookrightarrow] & \dots \\
			\dots \rar & F_{(1)}^{-2} \rar \dar[hookrightarrow] & F_{(1)}^{-1} \rar \dar[hookrightarrow] & F_{(1)}^0 \rar \dar[hookrightarrow] & F_{(1)}^{1} \rar \dar[hookrightarrow] & \dots \\
			\dots \rar & \dots \rar & \dots \rar & \dots \rar & \dots \rar & \dots
		\end{tikzcd}
	\]
	where each $F_{(i)}^k / F_{(i-1)}^k$ is free.
	Then the union $\cup_{i \geq 0} F_{(i)}^k$ is semi-free.
\end{ex}

\begin{prop}
	Semi-free modules are homotopically projective.
\end{prop}

\begin{prop}
	Every module admits a semi-free resolution.
\end{prop}

\section{Lecture 5, 6/28 (D. Arinkin) -- Modules}

Last time, for a classical ring $R$, we defined the DG-category $\Csf(R)$ of chain complexes of $R$-modules.
We further defined a subclass of ``semi-free'' objects in $\Csf(R)$.
Our goal will be to examine these concepts for DG-rings and more generally DG-categories.

\subsection{DG-Rings and their Modules}

Let $R$ be a DG-ring.
We can view the data of $R$ as:
\begin{enumerate}
	\item An underlying complex $R \in \Csf(k)$
	\item A degree-zero multiplication map $\cdot: R \otimes_k R \to R$ such that:
	\begin{enumerate}
		\item The (graded) product rule holds:
		\[
			d(ab) = (da) b + (-1)^{|a|} a db,
		\]
		(or equivalently $\cdot$ is a chain map).
		\item Multiplication is (strictly) associative.
		\item Multiplication is (strictly) unital.
	\end{enumerate}
\end{enumerate}

Given a DG-ring $R$, we can consider the category $\Csf(R)$ of \emph{DG-modules}(or \emph{modules} for short), i.e.\ chain complexes $M \in \Csf(k)$ equipped with a multiplication $R \otimes_k M \to M$ satisfying the usual module axioms together with a (graded) product rule.
We can view $\Csf(R)$ as a DG-category where $(\Hom_R(M, N))^i$ is the vector space of $R$-linear maps $M \to N$ of degree $i$ (with no regard for the differentials on $M$ and $N$).
The differential on $\Hom_R(M, N)^\bullet$ is given by the (graded) commutator $[d, -]$.
Note that $\Hom_R(M, N)$ is naturally a subcomplex of the $\Hom$-complex $\Hom_k(M, N)$ defined in the first lecture.

We can still make sense of the notion of freeness and semi-freeness in this context:

\begin{dfn}
	Let $R$ be a DG-ring and $M \in \Csf(R)$.
	A \emph{free $R$-module} is an $R$-module strictly isomorphic to one of the form $\oplus_{n \in \ZZ} R[n]^{\oplus I_n}$.
	A \emph{semi-free $R$-module} is an $R$-module of the form $M = \cup_{i=0}^\infty M_i$ where $M_0 \subset M_1 \subset \dots$ with each $M_i / M_{i-1}$ free.
\end{dfn}

If we ignore the differential $d$ (i.e.\ pretend that $R$ and $M$ both have $d = 0$), then semi-free modules are free: $M \cong \oplus_{i=0}^\infty M_i / M_{i-1}$.
However, in general, $d$ has interesting upper triangular behavior.

\begin{ex}
	Suppose $M = M_1$ where $M_0 = R e_0$ and $M_1 / M_0 = R e_1$.
	Then we can write $M \cong R \tilde{e_1} \oplus R e_0$ (ignoring differentials).
	Here $d$ satisfies $d(e_0) = 0$ and $d(\tilde{e_1}) = s e_0$ for some $s \in R$.
	It is a good exercise to find the conditions $s$ must satisfy for this to give a well-defined module.
\end{ex}

As one sees from this example, semi-free modules can be constructed inductively.
One can take these notions further and define ``twisted complexes.''

\subsection{Modules over DG-categories}

Recall that we can view a DG-ring $R$ as a DG-category with one object (say $*$ with $\End(*) = R$).
From this viewpoint, a right DG-module over $R$ is a contravariant DG-functor from the corresponding category to $\Csf(k)$.\footnote{The subtleties about covariance / contravariance and left / right cannot be avoided entirely.}
The free $R$-module $R \cdot 1$ is given by the representable functor $h_*$. 
The nice thing about this viewpoint is that the Yoneda embedding lets us start with a single free module and obtain all other modules as suitable colimits.

We can generalize this to talk about modules over a DG-category.

\begin{dfn}
	Let $\Asf$ be a DG-category.
	The \emph{DG-category of left $\Asf$-modules} $\Csf(\Asf)$ is given by $\Fun\dg(\Asf, \Csf(k))$.
	Here $\Hom_\Asf(M, N)$ is the complex of maps of functors $M \to N$ (not respecting the differential), with differential given by the (graded) commutator $[d, -]$.
	Right $\Asf$-modules are defined similarly, starting from $\Asf\op$.

	Taking $0$-cycles in $\Hom$-complexes gives $Z^0(\Csf(\Asf))$, the ``original'' category of DG-functors from $\Asf$ to $\Csf$.
	Morphisms in $Z^0(\Csf(\Asf))$ are genuine chain maps.
	We can also consider the homotopy category $\Ho \Csf(\Asf) = H^0(\Csf(\Asf)) = |\Csf(\Asf)|$.
\end{dfn}

One can think of a left $\Asf$-module $M$ as a collection of complexes $M(x)$ for $x \in \Asf$ together with maps $M(x) \to M(y)$ for every map $x \to y$ in $\Asf$ (respecting the unit and composition).
If $A$ is small, one can think of $M$ as a labeled diagram.

\begin{dfn}
	A basic free $\Asf$-module\footnote{This terminology is made up.} is given by a (co)representable functor $h_x = \Hom(x, -)$ for $x \in \Asf$.
	A general \emph{free $\Asf$-module} is a direct sum of shifts of basic free modules $h_{x_i}$ (for $x_i \in \Asf$).
	\emph{Semi-free $\Asf$-modules} are defined in the same way as before (i.e.\ as countable increasing unions of $\Asf$-modules with all relevant subquotients free). 
\end{dfn}

Note that if $M = \oplus_i h_{x_i}[d_i]$, then we can understand $M(a)$ concretely for any $a$:
\[
M(a) = \oplus_i \Hom(x_i, a)[d_i].
\]

\section{Lecture 6, 6/28 (B. Antieau) -- ???}

\subsection{More on $\infty$-categories}

Recall that an $\infty$-category is a weak Kan complex, i.e.\ a simplicial set satisfying an inner horn filling condition.
We can think of this as follows:
\begin{enumerate}
	\item $0$-simplices are objects.
	\item $1$-simplices are morphisms.
	\item $2$-simplices are homotopies / witnesses to composition.
	\item $3$-simplices homotopies between homotopies, etc.
\end{enumerate}

Here's another viewpoint.
Let $\Csf$ be an $\infty$-category.
For any $x, y \in \Csf$, we can define a Kan complex $\Map^R_\Csf(x, y)$ together with composition maps
\[
	\circ: \Map^R(x, y) \times \Map^R(y, z) \to \Map^R(x, z)
\]
which are defined, associative, unital, etc.\ all up to homotopy.
So $\infty$-categories are ``categories enriched in Kan complexes'' in a suitable sense.

A functor of $\infty$-categories is a just a map of the associated simplicial sets.
However, this can be hard to specify directly (since we need to declare where simplices at all levels go).
This happens even if we are considering maps $\Nsf(\Csf) \to \Dsf$, where $\Nsf(\Csf)$ is the nerve of a $1$-category and $\Dsf$ is an $\infty$-category.

\subsection{The $\infty$-category of spaces}

Let $\Spaces$ be the $\infty$-category of \emph{spaces} (or \emph{anima}, if you're hip).
The idea is that $\Spaces$ is to $\Cat_\infty$ as $\Set$ is to $\Cat_1$.
One can construct $\Spaces$ as follows.

Let $\Cat_\Delta$ be the category of \emph{simplicial categories} (i.e.\ categories enriched in simplicial sets).
In a simplicial category $\Csf$, morphisms form simplicial sets $\Map_\Csf(x, y)$, and composition, units, etc. are defined so that all identities hold on the nose.

There exists a \emph{homotopy-coherent nerve functor} $\Nsf_\bullet\hc: \Cat_\Delta \to \sSet$ given by $\Nsf_n\hc(\Csf) = \Hom_{\Cat_\Delta}(\tilde{[n]}, \Csf)$ (details including a definition of $\tilde{[n]}$ can be found in Kerodon or HTT).
If $\Map_\Csf(x, y)$ is a Kan complex for all $x, y \in \Csf$, then $\Nsf_\bullet\hc(\Csf)$ is an $\infty$ category, and we have a natural equivalence
\[
	\Map_\Csf(x, y) \simeq \Map_{\Nsf_\bullet\hc(\Csf)}^R(x, y).
\]
Recall that an equivalence of simplicial sets is just a (weak) homotopy equivalence of their geometric realizations.

\begin{dfn}
	The $\infty$-category of spaces $\Spaces$ is $\Nsf_\bullet\hc(\Kan)$, where $\Kan$ is the simplicial category of Kan complexes.
\end{dfn}

\begin{rmk}
	\,
	\begin{enumerate}
		\item Like $\Set$, $\Spaces$ has all (homotopy) limits and colimits.
			Recall that homotopy limits and colimits are computed using fibrant / cofibrant replacements, much like how we use projective / injective resolutions in derived categories.
		\item A functor of $\infty$-categories $F: \Csf \to \Dsf$ is fully faithful if, for all $x, y \in \Csf$, the induced map $\Map_\Csf(x, y) \to \Map_\Dsf(F(x), F(y))$ is an equivalence in $\Spaces$.\footnote{Here we write $\Map$ for the object of $\Spaces$ corresponding to the simplicial set $\Map^R$.}
			Such an $F$ is an equivalence if furthermore every $z \in \Dsf$ is equivalent to $F(x)$ for some $x \in \Csf$.
		\item We can view $\Spaces$ as obtained by inverting weak equivalences in $\Kan$ as an $\infty$-category (if we invert weak equivalences as a $1$-category, we just get $\Ho(\Spaces)$).
	\end{enumerate}
\end{rmk}

\subsection{Limits and Colimits}

Omitted for time...

\subsection{Model Categories}

\begin{dfn}
	A \emph{model category} is a category $\Csf$ with three distinguished classes of morphisms: \emph{weak equivalences} $W$, \emph{fibrations} $F$, and \emph{cofibrations} $C$, all closed under composition.
	From these we also get two more classes: \emph{trivial fibrations} $W \cap F$ and \emph{trivial cofibrations} $W \cap C$.
	These are required to satisfy the following axioms:
	\begin{enumerate}
		\item $\Csf$ has all limits and colimits.
		\item $W$ has a two-out-of-three property (if any two of $f$, $g$, and $g \circ f$ are in $W$, then the third is also in $W$).
		\item $W$, $F$, and $C$ are closed under retracts.
			(In particular they contain all isomorphisms.)
		\item In the following diagram
			\[
				\begin{tikzcd}
					A \rar \dar["i"] & X \dar["p"] \\
					B \rar \uar[dashed] & Y,
				\end{tikzcd}
			\]
			if $i$ is a cofibration and $p$ is a trivial fibration, or $i$ is a trivial cofibration and $p$ is a fibration, then the dashed lift exists.
		\item Every $f: X \to Y$ in $\Csf$ factorizes as a cofibration followed by a trivial fibration, and also as a trivial cofibration followed by a fibration.
	\end{enumerate}
	In fact, it suffices to define $W$ and $C$ (resp.\ $W$ and $F$), as the missing class of maps can be recovered as the class for which the lifting property of the fourth axiom holds.
	
	We say an object $X \in \Csf$ is fibrant (resp.\ cofibrant) if the map from $X$ to the final object is a fibration (resp.\ the map from the initial object to $X$ is a cofibration).
\end{dfn}

Model categories give a nice theory of ``inverting at weak equivalences.''
Furthermore, model categories provide notions of (left and right) homotopy.

\begin{dfn}
	Consider the ``fold map'' $X \sqcup X \to X$, and factorize this as a cofibration $X \sqcup X \to X \times I$ followed by a trivial fibration $X \times I \to X$.
	Here $X \times I$ is notation -- not a literal product of $X$ with an interval (though this is the intuition).
	We say that maps $f, g: X \to Y$ are left homotopic, written $f \sim^\ell g$, if $f \sqcup g: X \sqcup X \to Y$ factors through $X \sqcup X \to X \times I$.
\end{dfn}

If $X$ is cofibrant, then $\sim^\ell$ is an equivalence relation on $\Hom_\Csf(X, Y)$ for all $Y \in \Csf$.
We define $\pi_\ell(X, Y) = \Hom_\Csf(X, Y) / \sim^\ell$.
We can similarly define a notion of right homotopy $\sim^r$, which gives an equivalence relation on $\Hom_\Csf(X, Y)$ (and hence a definition of $\pi_r(X, Y)$) when $Y$ is fibrant.
When $X$ is cofibrant and $Y$ is cofibrant, these notions coincide, and we let $\pi(X, Y) = \pi_r(X, Y) = \pi_\ell(X, Y)$.

Let $\Csf\cf$ be the set of objects of $\Csf$ which are both fibrant and cofibrant.
We can make this into a category with $\Hom_{\Csf\cf}(X, Y) = \pi(X, Y)$.
This gives a construction of $\Csf[W\inv]$, i.e.\ $\Csf[W\inv] = \Csf\cf$.

\begin{dfn}
	An adjunction of model categories $F: \Csf \rightleftarrows \Dsf : G$ is a Quillen adjunction if it satisfies the following equivalent conditions:
	\begin{enumerate}
		\item $F$ preserves $C$ and $W \cap C$, or
		\item $G$ preserves $F$ and $W \cap F$, or
		\item $F$ preserves $C$ and $G$ preserves $F$, or
		\item $F$ preserves $W \cap C$ and $G$ preserves $W \cap F$.
	\end{enumerate}
\end{dfn}

For a Quillen equivalence, we can define a left derived functor $\Lbf F$ by setting $\Lbf F(Y)$ to be $F$ evaluated on a cofibrant replacement of $Y$.

\subsection{CDGAs}

One category of ``derived commutative rings'' is given by $\CDga_{\QQ,\geq 0}$, the category of connective (i.e.\ homologically non-negatively graded) CDGAs.
We say that a map $f: A_\bullet \to B_\bullet$ is an equivalence if it is a quasi-isomorphism of complexes.

One can show that $\CDga_{\QQ, \geq 0}$ has a model category structure with
\begin{enumerate}
	\item $W$ is equivalences (i.e.\ quasi-isomorphisms).
	\item $F$ is the class of $A_\bullet \to B_\bullet$ which are degreewise surjections in positive degrees (not necessarily $0$).
	\item $C$ is determined by $W$ and $F$.
\end{enumerate}
In this model category structure, all objects are fibrant (the map to the zero CDGA is always a levelwise surjection).

Why are we restricting to nonnegatively graded CDGAs?
The positive homotopy / homology groups should capture ``nilpotence'' in derived algebraic geometry.
By contrast, negative homotopy / homology groups capture stacky behavior.
Another problem is that quasicoherent sheaf theory is poorly understood in the non-connective case.

\begin{dfn}
	Let $\DAlg_\QQ\cn$ be the $\infty$-category associated to $\CDga_{\QQ, \geq 0}$.\footnote{To construct this, one would like a simplicial model structure on $\CDga_{\QQ, \geq 0}$, but this does not seem to appear directly in the literature.
	Indirect approaches are possible.}
\end{dfn}

There exists an adjunction $\DAlg_\QQ\cn \leftrightarrows \CAlg_\QQ$, where the top map is given by $A_\bullet \mapsto H_0(A) = \pi_0(A)$.
This lets us reduce some questions about a connective CDGA to questions about an ordinary commutative ring.
It is not clear what a useful analogue of this would be for non-connective CDGAs.

\begin{ex}
	There exists a Quillen adjunction 
	\[
		\Sym_\QQ: \Ch_{\geq 0}(\QQ) \leftrightarrows \CDga_{\QQ, \geq 0}: \textrm{forget}.
	\]

	(The model structure on $\Ch_{\geq 0}(\QQ)$ is defined with the same conditions used for $\CDga_{\QQ, \geq 0}$, and every object in $\Ch_{\geq 0}(\QQ)$ is fibrant and cofibrant.)
	This adjunction yields an adjunction of $\infty$-categories 
	\[
		\Sym_\QQ: \Dsf_{\geq 0}(\QQ) \leftrightarrows \DAlg_\QQ\cn: \textrm{forget}.
	\]
	One can compute the image of $\Sym_\QQ$ explicitly:
	\[
		\Sym_\QQ(\QQ[n]) \simeq 
		\begin{cases}
			\QQ[x_n] & n \textrm{ even} \\
			\QQ[x_n] / (x_n^2) & n \textrm{ odd,}
		\end{cases}
	\]
	where the differentials are trivial in both cases.

	Furthermore, we have
	\[
		\Map_{\DAlg_\QQ\cn}(\Sym_\QQ(\QQ[n], A) \simeq \Map_{\Dsf_{\geq 0}(\QQ)}(\QQ[n], A) \simeq \Map_{\Dsf_{\geq 0}(\QQ)}(\QQ, \tau_{\geq 0} A[-n]).
	\]
	Thus
	\[
		\pi_i(\Map_{\DAlg_\QQ\cn}(\Sym_\QQ(\QQ[n], A)) \cong \pi_i(\Map_{\Dsf_{\geq 0}(\QQ)}(\QQ, \tau_{\geq 0} A[-n])) \cong
		\begin{cases}
			0 & i < 0 \\
			\pi_{i-n}(A) = H_{i-n}(A) & i \geq 0.
		\end{cases}
	\]
\end{ex}

\begin{ex}
	We can also try to understand quotients of symmetric CDGAs.
	Say we want to construct something that behaves like $\QQ[x_{2n}] / (x_{2n}^2)$.
	The na\"ive construction produces an object which is not cofibrant.
	It is better to instead consider the homotopy pushout $A = \QQ[x_{2n}] \otimes_{\QQ[x_{4n}]} (\QQ[x_{4n}] \otimes \bigwedge_\QQ (y_{4n+1})$, where in the latter tensor factor we set $d(y_{4n+1}) = x_{4n}$.
	We end up with $A \cong \QQ[x_{2n}] \otimes \bigwedge_\QQ(y_{4n+1})$, with $d(y_{4n+1}) = x_{2n}^2$.
\end{ex}

\section{Lecture 7, 6/29 (B. Antieau) -- Construction of $\infty$-Categories and More Derived Commutative Rings}

\subsection{Bootstrapping}

To clarify some points that may have been confusing in the last lecture, we will discuss some of the ``bootstrapping'' processes we use in the study of $\infty$-categories.

Consider the $1$-categories $\sSet$ (of simplicial sets) and $\Cat_\Delta$ (of simplicial categories).
Both of these are model categories:
\begin{itemize}
	\item In the Joyal model structure on $\sSet$, $W$ consists of ``categorical equivalences'' (arising from the following Quillen adjunction) and $C$ consists of monomorphisms.\footnote{Last time, we considered the Quillen model structure, where $W$ consists of $f$ such that the geometric realization $|f|$ is a weak homotopy equivalence.}
	\item In the model structure on $\Cat_\Delta$, $W$ consists of $\sSet$-enriched equivalences, i.e.\ $F: \Csf \to \Dsf$ such that $\abs{\Map_\Csf(x, y)} \to \abs{\Map_\Dsf(F(x), F(y))}$ is a weak homotopy equivalence for all $x, y$, and $F$ is essentially surjective up to $\simeq$.
\end{itemize}
We have a Quillen adjunction 
\[
	\Path[-]: \sSet \leftrightarrow \Cat_\Delta :\Nhc(-).
\]

Note that maps of simplicial sets naturally form a simplicial set:
\[
	\Map_\sSet(X_\bullet, Y_\bullet)_n = \Hom_\sSet(X_\bullet \times \Delta^n, Y_\bullet).
\]
If $X_\bullet$ and $Y_\bullet$ are $\infty$-categories, then $\Map_\sSet(X_\bullet, Y_\bullet)$ is an $\infty$-category.

Let $\WKan$ be the simplicial category with objects weak Kan complexes and morphisms given by the maximal sub-Kan complex of $\Map_\sSet(X_\bullet, Y_\bullet)$.
Then we can define $\Cat_\infty$, the \emph{$\infty$-category of $\infty$-categories} as
\[
	\Cat_\infty = \Nhc(\WKan).
\]
Note that this construction loses information: we'd really rather have an $(\infty, 2)$-category of $(\infty, 1)$-categories, but this would require a good theory of $(\infty, 2)$-categories.

Another approach to bootstrapping $\infty$-categories is as follows.
Suppose we have a ``simplicial model category'' $\Msf$ -- this implies in particular that the simplicial enrichment on the full subcategory $\Msf\cf$ of fibrant-cofibrant objects is actually an enrichment in Kan complexes.
Then $\Nhc(\Msf\cf)$ is an $\infty$-category.

For a general model category $\Msf$, we can construct a ``hammock localization'' $L^H \Msf$, which is a simplicial category.
We can furthermore apply a functor $\Ex\infty$ which turns simplicial categories into categories enriched in Kan complexes.
Applying $\Nhc$ gives an $\infty$-category $\Nhc(\Ex^\infty(L^H \Msf))$.
More details can be found in a paper of Dwyer and Kan.

A third approach involves starting with a category $\Msf$ with a notion of weak equivalences $W$ and constructing an $\infty$-category $\Nsf_\bullet(\Msf)[W\inv]$ satisfying the expected universal property of localization in $\infty$-categories.

A final approach works for DG-categories.
Starting from a DG-category $\Csf$, Lurie gives a direct construction of the DG-nerve $\Ndg(\Csf)$, which is an $\infty$-category.
Alternatively, using Dold-Kan (and systematically using good truncations), we can convert $\Csf$ into a simplicially enriched category and instead construct $\Nhc(\Csf)$.
There is a natural map $\Nhc(\Csf) \to \Ndg(\Csf)$, which Lurie shows is a trivial fibration.
The resulting $\infty$-category will be stable if $\Csf$ is pre-triangulated.

\subsection{More on derived commutative rings}

Recall some relevant model categories:
\begin{itemize}
	\item $\CDga_{\QQ,\geq 0}$ has $W$ consisting of qisos and $F$ consisting of degreewise surjections in positive degrees. 
		The corresponding $\infty$-category is $\DAlg_\QQ\cn$.
	\item $\Ch_{\geq 0}(\QQ)$ has $W$ consisting of qisos, $F$ consisting of degreewise surjections in positive degrees, and $C$ consisting of degreewise injections.
		The corresponding $\infty$-category is $\Dsf(\QQ)_{\geq 0}$.
	\item $\Ch(\QQ)$ has $W$ consisting of qisos, $F$ consisting of degreewise surjections, and $C$ consisting of degreewise injections.
		The corresponding $\infty$-category is $\Dsf(\QQ)$.
\end{itemize}

\begin{ex}
	Why are we working over $\QQ$?
	The answer is that strange and undesirable phenomena can occur if we work na\"ively over $\ZZ$.
	Considering the chain complex $A_\bullet$ given by
	\[
		\begin{tikzcd}
			\dots & 0 \lar & \ZZ \lar & \ZZ \lar["\id"] & 0 \lar & \dots \lar
		\end{tikzcd}
	\]
	with $\ZZ$'s appearing in degree $1$ and $2$
	Then $\Sym_\ZZ^{\CDga}(A_\bullet) = \ZZ[x] \otimes \ZZ[y] / (2y^2)$ with $dx = y$ and $dy = 0$.
	In particular $d(x^n) = n x^{n-1} y$, and since $n$ is not invertible, we obtain $H_{2n-1} \cong \ZZ / n$.
	But the chain complex we started with is acyclic and cofibrant, so we would hope to get a ``symmetric algebra'' which is also acyclic.
	This example shows that there is no model structure on $\CDga_{\ZZ, \geq 0}$ such that the usual monadic adjunction $\Ch_{\geq 0}(\ZZ) \leftrightarrow \CDga_{\ZZ, \geq 0}$ is a Quillen adjunction.
\end{ex}

How can we make things work over $\ZZ$?

\subsection{Animated (simplicial) commutative rings}

When working over $\ZZ$, we instead consider $\ssf\CAlg_\ZZ$, the category of simplicial commutative rings, equipped with a model structure where $W$ and $F$ are as in the Quillen model structure on the underlying simplicial sets.
(This definition makes sense over any commutative ring $R$.)
We will write $\DAlg_R\cn$ for the $\infty$-category obtained by localizing $\ssf\CAlg_R$ at weak equivalences.
For $R = \QQ$, this yields an $\infty$-category equivalent to the one constructed earlier.

The usual ``free algebra / abelian group'' monadic adjunctions extend to Quillen adjunctions between $\sSet$, $\ssf\Ab$, and $\ssf\CAlg_R$.
When working with the corresponding $\infty$-categories, we consider the corresponding derived functors.

\begin{ex}
	\begin{enumerate}
		\item $\pi_\bullet \Lbf \Sym (\ZZ[0]) = \ZZ[x]$ with $|x| = 0$.
		\item $\pi_\bullet \Lbf \Sym (\ZZ[1]) = \bigwedge_\ZZ(y) = \ZZ[y] / y^2$ with $|y| = 1$.
		\item $\pi_\bullet \Lbf \Sym (\ZZ[2]) = \Gamma_{\mathrm{pd}(z)}$, the divided power algebra in $\QQ[z]$ spanned over $\ZZ$ by the elements $z^n / n!$.
			Here $|z| = 2$.
	\end{enumerate}
\end{ex}

The complexity of $\Lbf \Sym$ can be understood from the following Lemma.

\begin{lem}
	For $n \geq 2$, we have $\Lbf \Sym (\ZZ[n]) = C_\bullet(K(\ZZ, n), \ZZ)$.
\end{lem}

This can be proved using the bar resolution (for $K(\ZZ, n) = \pt / K(\ZZ, n-1)$) and the equivalence
\[
	C_\bullet(K(\ZZ, n), \ZZ) \simeq \ZZ \otimes_{C_\bullet(K(\ZZ, n), \ZZ)}^\Lbf \ZZ.
\]

The adjunction $\Dsf(\ZZ)_{\geq 0} \leftrightarrow \DAlg_\ZZ\cn$ forms a commutative square of adjunctions with $\Mod_\ZZ \leftrightarrow \CAlg_\ZZ$ (where the maps from classical objects to derived objects are inclusions and the maps from derived objects to classical objects are $\pi_0$).

One way of understanding $\DAlg_\ZZ\cn$ is through the following Theorem.

\begin{thm}[Quillen, Lurie]
	The inclusion $\CAlg_\ZZ^{\mathrm{fp,poly}} \hookrightarrow \DAlg_\ZZ\cn$ (where the left hand side is the category of classical finitely generated polynomial rings) induces an equivalence
	\[
		\Fun_\Sigma(\DAlg_\ZZ\cn, \Dsf) \simeq \Fun(\CAlg_\ZZ^{\mathrm{fp,poly}}, \Dsf)
	\]
	for any $\Dsf$ with sifted colimits (where $\Fun_\Sigma$ denotes sifted colimit preserving functors).
\end{thm}

Recall that $\DAlg_\ZZ\cn$ is presentable, so it has all colimits.
In this context, $F: \DAlg_\ZZ\cn \to \Dsf$ preserves sifted colimits if it preserves filtered colimits and geometric realizations.
``Filtered'' here means $\omega$-filtered, where a simplicial set $I$ is $\kappa$-filtered (for some regular cardinal $\kappa$) if for every $J$ with a $\kappa$-small set of nondegenerate simplices, if $J^\triangleright$ denotes $J$ with a cone point added on the right, then every map $J \to I$ factors through $J^\triangleright$.
Directed colimits give one example of filtered colimits.

The above theorem lets us construct (sifted colimit-preserving) functors out of $\DAlg_\ZZ\cn$ ``by hand,'' i.e\ by defining them explicitly on $\CAlg_\ZZ^{\mathrm{fp,poly}}$.
For example, we can define de Rham cohomology in this way.

\section{Lecture 8, 6/29 (D. Arinkin) -- Perspectives on Modules}

For a DG-category $\Asf$, we defined the DG-category $\Csf(\Asf)$ of left $\Asf$-modules (i.e.\ DG-functors $\Asf \to \Csf(k)$) and the subcategory of semi-free modules $\Csf(\Asf)\sfr$.
Here are some useful perspectives on these categories.

First: the Yoneda embedding gives a functor $h: \Asf \hookrightarrow \Csf(\Asf\op)$, and the image of $h$ generates the subcategory $\Csf(\Asf\op)\sfr$ under shifts, direct sums, and countable extensions.
Since $\Csf(\Asf\op)\sfr$ is closed under shifts, direct sums,  and finite extensions, it is also closed under cones and homotopy colimits.
We write $\Csf(\Asf\op)\sfr = \Ind(\Asf)$, the \emph{ind-completion} of $\Asf$.

Second: the DG-category $\Csf(\Asf)\sfr$ is ``basically'' the derived category $\Dsf(\Asf)$.
More precisely, note that we can define acyclicity and qisos in $\Csf(\Asf)$ pointwise.
Then:

\begin{prop}
	\,
	\begin{enumerate}
		\item For all $M \in \Csf(\Asf)$, there is a qiso $F \to M$ for $F \in \Csf(\Asf)\sfr$.
		\item For all $F \in \Csf(\Asf)\sfr$ and acyclic $N \in \Csf(\Asf)$, $\Hom(F, N)$ is acyclic.
	\end{enumerate}
\end{prop}

\begin{cor}
	The composite $\Csf(\Asf)\sfr \hookrightarrow \Csf(\Asf) \to \Csf(\Asf) / \Csf(\Asf)\acy = \Dsf(\Asf)$ is a quasi-equivalence.
\end{cor}

Third: Embedding into $\Csf(\Asf\op)$ gives a ``nicer version'' of $\Asf$.
Suppose we have a DG-functor $F: \Asf \to \Bsf$.
We obtain a ``restriction'' functor $\Csf(\Bsf\op) \to \Csf(\Asf\op)$ via $(F: \Bsf\op \to \Csf(k)) \mapsto (\Asf\op \to \Bsf\op \to \Csf(k)$.
Note that the square
\[
	\begin{tikzcd}
		\Asf \rar[hook, "h"], \dar["F"] & \Csf(\Asf\op) \dar \\
		\Bsf \rar[hook, "h"] & \Csf(\Bsf\op)
	\end{tikzcd}
\]
does not commute.
For example, the restriction of a free module may no longer be free.

We also have an ``extension'' functor $\Csf(\Bsf\op) \Csf(\Asf\op)$ (defined using $\otimes$), which does form a commutative square
\[
	\begin{tikzcd}
		\Asf \rar[hook, "h"], \dar["F"] & \Csf(\Asf\op) \\
		\Bsf \rar[hook, "h"] & \Csf(\Bsf\op) \uar
	\end{tikzcd}
\]

In particular, suppose $F$ is a quasi-equivalence.
Recall from the problem sets that $F$ need not have a ``quasi-inverse'' $\Bsf \to \Asf$.
However, let $h(\Asf)$ and $h(\Bsf)$ be the respective quasi-essential images under the Yoneda embedding (both consisting of ``free rank-$1$ unshifted complexes up to qiso'').
Then extension gives a quasi-equivalence $h(\Asf) \to h(\Bsf)$, and restriction (being the right adjoint of extension) gives an inverse quasi-equivalence.
That is, passing to $h(-)$ creates quasi-inverses for quasi-equivalences.
We can think of this as a form of fibrant replacement.

\begin{dfn}
	A \emph{quasi-functor} $\Asf \to \Bsf$ is a DG-functor $F: \Asf \to \Csf(\Bsf\op)$ with image contained in $h(\Bsf)$.
\end{dfn}

We can think of a quasi-functor $F$ as an ``$(\Asf, \Bsf)$-bimodule'' such that the underlying $\Bsf$-module lies in $h(\Bsf)$.

\begin{rmk}
	Given DG-categories $\Asf$ and $\Bsf$, we define a new DG-category $\Asf \otimes \Bsf$ as follows:
	\begin{itemize}
		\item $\Ob (\Asf \otimes \Bsf) = \Ob (\Asf) \times \Ob (\Bsf)$.
		\item $\Hom_{\Asf \otimes \Bsf}(a_1 \otimes b_1, a_2 \otimes b_2) = \Hom_\Asf(a_1, a_2) \otimes_k \Hom_\Bsf(b_1, b_2)$.
		\item Composition involves a sign rule.
	\end{itemize}
	An $(\Asf, \Bsf)$-bimodule is an $\Asf \otimes \Bsf\op)$-module.
\end{rmk}

Recall that $\Csf(\Asf\op)\sfr$ is generated by $h(\Asf)$ under shifts, direct sums, and infinite extensions.
We can also consider smaller subcategories.
For example, the subcategory $\Asf\pretr$ generated by $h(\Asf)$ under finitely iterated cones, finite direct sums (a special case of cones), and shifts gives the category of ``finitely generated semifree modules.''
We call $\Asf\pretr$ the \emph{pre-triangulated completion of $\Asf$} (because $\Ho(\Asf\pretr)$ is triangulated).

\begin{ex}
	If $R$ is a classical ring, the pre-triangulated completion of $R$ (viewed as a one-object DG-category) gives the category of bounded complexes of free modules of finite rank.
\end{ex}

\begin{dfn}
If $h: \Asf \to \Asf\pretr$ is a quasi-equivalence, we say that $\Asf$ is a \emph{pre-triangulated DG-category}.
\end{dfn}

\begin{exer}
	Describe explicit conditions for $\Asf$ to be pre-triangulated.
\end{exer}

\begin{rmk}
	Perfect modules do not quite fit into the picture discussed so far -- we also need to allow for (homotopy) direct summands.
\end{rmk}

\section*{Discussion, 6/29 (K. Schefers) - Homotopical Thinking}

The goal of this discussion is to teach some ``folk $\infty$-category theory'' -- i.e.\ intuition for $\infty$-categories and homotopy theory.

A key slogan: ``Never say `equals,' only `equivalent.'''
In practice, this means that we religiously avoid the word ``is'' when comparing two objects.
This is essentially taking the notion of ``equivalence'' from $1$-category theory to its logical extreme.

\begin{ex}
In the setting of $\infty$-categories, we have notions of objects, morphisms, functors, and composition.
However, we do not have a notion of faithful functors.
Let's explain why.

In $1$-category theory, a functor $F$ is faithful if, whenever $f \neq g$, it follows that $F(f) \neq F(g)$.
In $\infty$-category theory, it is possible that $f \simeq g$ but $f \neq g$, so injectivity of $\Map(x, y) \to \Map(F(x), F(y))$ no longer makes sense.
\end{ex}

If we pass to $\pi_0$ (i.e.\ to the homotopy category), we can regain some $1$-categorical notions.
As one expects, this loses a lot of information.

One might wonder how homotopy types arise out of this perspective.
Suppose we have an $\infty$-category (say a Kan complex) $\Csf$ and $x, y \in \Ob \Csf$.
We cannot ask that $x = y$, only that we have an equivalence $f: x \tilde{\rightarrow} y$.
This can be viewed as a $1$-simplex from $x$ to $y$.
Similarly, given $f, g: x \tilde{\rightarrow} y$, we cannot ask that $f = g$, only that we have an equivalence $f \tilde{\rightarrow} g$.
This would give a $2$-simplex.
Continuing on with higher morphisms would give a homotopy type corresponding to $\Map(x, y)$.

\section{Lecture 9, 6/30 (D. Arinkin) -- Different DG-Categories of Modules}

\subsection{Refresher on quasi-functors}

Recall that we want to consider DG-categories up to quasi-equivalence.
This can be made precise using a model structure on the category of DG-categories due to Tabuada.\footnote{One has to be cautious about the $2$-category theory involved.
Drinfeld asked the famous question, ``What do DG-categories form?''
We will not provide a complete answer to this question here.}

\begin{thm}[To\"en]
	After localization, the category of morphisms between $\Asf, \Bsf \in \DGCat$ ``is'' the derived category of quasifunctors from $\Asf$ to $\Bsf$.
\end{thm}

Recall that a quasi-functor from $\Asf$ to $\Bsf$ is an $(\Asf, \Bsf)$-bimodule $M$ (i.e.\ an $(\Asf \otimes \Bsf\op)$-module) such that, for any $a \in \Asf$, the corresponding $\Bsf\op$-module is quasi-representable.
Explicitly, if we view $M$ as $M: \Asf \otimes \Bsf\op \to \Csf(k)$ and fix $a \in \Asf$, then the functor $M(a, -): \Bsf\op \to \Csf(k)$ is qiso to $h_b$ for some $b \in \Bsf$.

\subsection{Various categories of modules}

Let $\Asf$ be a DG-category.
Recall that $\Csf(\Asf\op)$ contains a subcategory $\Ind(\Asf) = \Csf(\Asf\op)\sfr$ obtained from $\Asf$ using direct sums, cones, shifts, and countable extensions.
We have a further subcategory $\Asf\pretr \subset \Ind(\Asf)$ obtained from $\Asf$ using cones and shifts.
A variant of this construction is the ``Karoubi completion'' $(\Asf\pretr)\Kar$, given by
\[
	\{ x \in \Csf(\Asf\op) \, | \, \exists y \textrm{s.t.} x \oplus y \in \Asf\pretr \}.
\]
Modules satisfying this condition are called \emph{perfect}, and we also write this last category as $\Perf(\Asf\op)$.

Thus, in increasing order, we have:
\begin{enumerate}
	\item $\Asf$, an arbitrary DG-category.
	\item $\Asf\pretr$, a pre-triangulated DG-category.
	\item $\Perf(\Asf\op)$, a Karoubian pre-triangulated DG-category.
	\item $\Ind(\Asf) = \Dsf(\Asf\op)$, a cocomplete (pre-triangulated) DG-category.
\end{enumerate}

If we consider a classical ring as a one-object DG-category, these four levels correspond to:
\begin{enumerate}
	\item $R$ as a one-object DG-category.
	\item The DG-category of bounded complexes of finite-rank free $R$-modules.
	\item The DG-category of bounded complexes of finite-rank projective $R$-modules.
	\item The DG-derived category of $R$.
\end{enumerate}

\begin{rmk}
	In a general DG-category, shifts and cones need not exist.
	However, those that exist are natural and ``as unique as possible.''
	In particular, they are preserved by DG functors.
\end{rmk}

\begin{ex}
	Consider $\Csf(\Asf\pretr)$, the category of DG-functors $\Asf\pretr \to \Csf(k)$.
	Such functors are determined by their values on $\Asf \subset \Asf\pretr$, so $\Csf(\Asf\pretr) \tilde{\to} \Csf(\Asf)$.
	Therefore, when considering categories of modules, we may as well assume that $\Asf$ is pretriangulated.
\end{ex}

The above Example shows in particular that $(\Asf\pretr)\pretr \simeq \Asf\pretr$.
Similarly, we can show that $(((\Asf\pretr)\Kar)\pretr)\Kar \simeq (Asf\pretr)\Kar$.
However, $\Ind(-)$ is not an idempotent operation, i.e.\ $\Ind(\Ind(\Asf)) \not\simeq \Ind(\Asf)$, as the construction of $\Ind$ ``freely adds colimits.''
This can be explained by the fact that DG-functors do not automatically respect infinite direct sums.
However, we do have $\Ind((\Asf\pretr)\Kar) \simeq \Ind(\Asf)$.

\subsection{Small and large DG-categories}

We would like to separate DG-categories into ``small'' and ``large'' classes.
The following gives a notion of what we will consider ``large.''

\begin{dfn}
	A DG-category is (cocomplete) compactly generated if it is quasi-equivalent to $\Ind(\Asf)$ for some $\Asf$.
\end{dfn}

We can pass from ``small'' DG-categories to ``large'' DG-categories by taking $\Ind$.
To go from ``large'' DG-categories to ``small'' DG-categories, we pass to the subcategory of compact objects.

We would like these operations to be functorial in the DG-categories involved.
For ``small'' categories, we consider DG (quasi-)functors, while for ``large'' categories we must consider \emph{continuous} (i.e.\ colimit-preserving) DG (quasi-)functors.

Suppose that a DG-functor $F: \Ind(\Asf_1) \to \Ind(\Asf_2)$ is continuous.
Then $F$ is determined by its values on $\Asf_1$, but it need not be induced by a (quasi-)functor $\Asf_1 \to \Asf_2$.
Thus $\Ind$ is not a full functor (i.e.\ more morphisms appear).

\section{Lecture 10, 6/30 (B. Antieau) -- More $\infty$-categories and derived commutative rings} 

Recall that for a commutative ring $k$, we define $\DAlg_k\cn := \ssf\CAlg_k[W\inv]$.

\begin{thm}[Quillen, Lurie]
	If $\Dsf$ is an $\infty$-category with sifted colimits, then
	\[
		\Fun_\Sigma(\DAlg_k\cn, \Dsf) \tilde{\to} \Fun(\CAlg_k^{\mathrm{fp,poly}}, \Dsf),
	\]
	where $\Fun_\Sigma$ denotes the $\infty$-category of sifted colimit-preserving functors.
\end{thm}

\subsection{Presentable $\infty$-categories}

\begin{dfn}
	An $\infty$-category $\Csf$ is \emph{presentable} if it is an accessible localization
	\[
		\Psh(\Csf_0) \leftrightarrow \Csf
	\]
	for some small $\infty$-category $\Csf_0$, where $\Psh(\Csf_0) = \Fun(\Csf_0\op, \Spaces)$.
	The ``accessible localization'' condition means that $\Csf \to \Psh(\Csf_0)$ is fully faithful and preserves $\kappa$-filtered colimits for some $\kappa$.
\end{dfn}

Here are some useful facts.
\begin{enumerate}
	\item Presentable $\infty$-categories have all colimits and limits.
	\item Left adjoints (always) preserve colimits, and right adjoints (always) preserve colimits.
		The adjoint functor theorem below gives a converse to this.
\end{enumerate}

\begin{thm}[Adjoint Functor Theorem]
	\,
	\begin{enumerate}
		\item Let $\Csf$ be a presentable $\infty$-category, $\Dsf$ an $\infty$-category with all colimits, and $F: \Csf \to \Dsf$ a colimit-preserving functor.
			Then $F$ admits a right adjoint.
		\item Let $\Csf$ and $\Dsf$ be presentable $\infty$-categories and $G: \Dsf \to \Csf$ a functor that preserves limits and $\kappa$-filtered colimits for some $\kappa$.
			Then $G$ admits a left adjoint.
	\end{enumerate}
\end{thm}

The reason ``$\kappa$-filtered colimits'' are so important here is that presentable $\infty$-categories have generators which are ``$\kappa$-compact,'' so behavior of presentable $\infty$-categories can be understood by looking at these generators.

Presentability is often obvious in practice from the construction of an $\infty$-category.
Lurie showed in HTT that many relevant model categories have presentable homotopy-coherent nerves.

Here are some examples of adjunctions (I was a bit rushed and might have gotten the handedness wrong).

\begin{ex}
	The $\infty$-category $\Spaces$ of spaces has a natural adjunction $\pi_0: \Spaces \leftrightarrow \Set :G$.
	Both categories here are presentable.
	However, $G$ does not preserve colimits.
	For a simplicial set $X_\bullet$, the colimit in $\Set$ is just the coequalizer of $X_1 \rightrightarrows X_0$, whereas the coequalizer in $\Spaces$ is the geometric realization $|X_\bullet|$.
	(In particular, one can consider the pushout $\pt \sqcup_{S^0} \pt$.)
\end{ex}

\begin{ex}
	Let $I$ be a simplicial set, and write $\Spaces^I = \Fun(I, \Spaces)$.
	The constant functor $\Spaces \to \Spaces^I$ preserves both limits and colimits.
	Therefore this constant functor has a left adjoint (viz.\ $I$-indexed colimits) and a right adjoint (viz.\ $I$-indexed limits).
\end{ex}

\begin{ex}
	Similarly, the inclusion $\Spaces \to \Cat_\infty$ preserves both limits and colimits.
	The right adjoint is the ``groupoid core'' functor, and the left adjoint is the ``geometric realization'' functor.
\end{ex}

\begin{ex}
	The functor $\Cat \to \Cat_\infty$ preserves limits and has a left adjoint given by the ``homotopy category'' functor $\Csf \mapsto \Ho \Csf$.
\end{ex}

Here are a few constructions we can make starting from an $\infty$-category $\Csf$.
The constructions are listed in decreasing order of inclusion (i.e.\ $\Ind(\Csf) \subset \Psh_\Sigma(\Csf) \subset \Psh(\Csf)$).
Details can be found in Chapter 5 of HTT.
\begin{enumerate}
	\item For any $\Csf$, we can define $\Psh(\Csf) = \Fun(\Csf\op, \Spaces)$.
		The corresponding Yoneda embedding preserves no colimits.
		For any presentable $\Dsf$, we have $\Fun(\Csf, \Dsf) = \Fun^L(\Psh(\Csf), \Dsf)$, the category of left adjoint functors.
		Every object of $\Psh(\Csf)$ is a colimit of representables.
	\item For any $\Csf$ with finite coproducts, we can define $\Psh_\Sigma(\Csf) = \Fun^{\prod}(\Csf\op, \Spaces)$, the category of finite-product-preserving presheaves.
		The corresponding Yoneda embedding preserves finite coproducts.
		For any presentable $\Dsf$, we have $\Fun(\Csf, \Dsf) = \Fun_\Sigma(\Psh_\Sigma(\Csf), \Dsf)$.
		We have $\Fun^{\coprod}(\Csf, \Dsf) = \Fun^L(\Psh_\Sigma(\Csf), \Dsf)$.
		Every object of $\Psh(\Csf)$ is a geometric realization $|X_\bullet|$ where each $X_n$ is a filtered colimit of representables.
	\item For any $\Csf$ with finite coproducts, we can define $\Ind(\Csf) = \Fun^{\mathrm{lex}}(\Csf\op, \Spaces)$, the category of finite-limit-preserving presheaves.
		The corresponding Yoneda embedding preserves finite colimits.
		For any presentable $\Dsf$, we have $\Fun(\Csf, \Dsf) = \Fun_\omega(\Ind(\Csf), \Dsf)$, the category of filtered-colimit-preserving functors.
		We have $\Fun^{\mathrm{rex}}(\Csf, \Dsf) = \Fun^L(\Ind(\Csf), \Dsf)$.
		Every object of $\Psh(\Csf)$ is a filtered colimit of representables.
\end{enumerate}

\begin{rmk}
	The filtered simplicial sets $I$ are exactly those such that $\colim: \Spaces^I \to \Spaces$ preserves finite limits.
	Similarly, $I$ is sifted if and only if $\colim: \Spaces^I \to \Spaces$ preserves finite coproducts.
\end{rmk}

\subsection{Animation}

Let's return to the Theorem from the start of the lecture.
From the above perspective, we can reinterpret the theorem as coming from an equivalence
\[
	\DAlg_k\cn \simeq \Psh_\Sigma(\CAlg_k^{\mathrm{fp,poly}}).
\]

The $\Psh_\Sigma$ construction is useful enough that people call it \emph{animation} and write $\An(-) = \Psh_\Sigma(-)$.
People like to think of this as capturing the ``spirit'' or ``anima.''

\begin{ex}
	$\Spaces \simeq \An(\FinSet) \simeq \Psh(\pt) \simeq \Ind(\textrm{compact spaces})$.
\end{ex}

\begin{ex}
	An $\infty$-categorical version of Dold-Kan gives $\Dsf(\ZZ)_{\geq 0} \simeq \An(\Mod_\ZZ^{\textrm{free,fp}})$.
\end{ex}

\subsection{$\EE_\infty$-rings}

Another useful flavor of ``derived commutative rings'' is given by $\EE_\infty$-rings.
These arise as algebras / modules (terminology is inconsistent in general) for a monad on $\Dsf(k)$.

Recall that a monad $T$ on an $\infty$-category $\Csf$ is just an algebra object in the monoidal category of endofunctors $\End(\Csf)$ (what's the problem?).
This means we have a composition $T^2 \to T$ and a unit $\id \to T$ satisfying some (homotopy-)commutative diagrams.
A $T$-algebra $X$ is an object $X \in \Csf$ together with a map $TX \to X$ again satisfying some (homotopy-)commutative diagrams.

The ``free $\EE_\infty$-algebra'' monad on $\Dsf(k)$ is given by
\[
	T(M) = \oplus_{n \geq 0} (M^{\otimes n})_{h \Sigma_n},
\]
where the subscript $h \Sigma_n$ refers to homotopy $\Sigma_n$-orbits.
A $T$-algebra $A$ therefore comes with a ``product map''
\[
	\oplus_{n \geq 0} (A^{\otimes n})_{h \Sigma_n} \to A,
\]
where factoring through homotopy $\Sigma_n$-orbits captures the commutativity of the product.

\begin{ex}
	The free $\EE_\infty$-algebra on $\ZZ$ is given by $\oplus_{n \geq 0} (\ZZ^{\otimes n})_{h \Sigma_n}$.
	Computing homology ends up giving the group homology groups $H_*(\Sigma_n, \ZZ^{\sigma(n)})$.
	These are ``free'' but complicated and very ``non-flat,'' explaining why many people prefer to consider simplicial commutative rings.
\end{ex}

We write $\CAlg_k^{\EE_\infty}$ for the $\infty$-category of $\EE_\infty$-rings.
If we consider $\EE_\infty$-algebras in $\Dsf(k)_{\geq 0}$, we obtain a subcategory $\CAlg_k^{\EE_\infty}$ of connective $\EE_\infty$-rings.
Note that we can now make sense of non-connective ``derived commutative rings.''

\subsection{Four flavors of derived commutative rings}

Let us recall our previous categories of derived commutative rings and introduce a new example.
\begin{enumerate}
	\item For $k \supset \QQ$, we can define $\DAlg_k\cn = \CDga_{k, \geq 0}[W\inv]$.
		This is very concrete but does not work over $\ZZ$.
	\item For any $k$, we can define $\DAlg_k\cn = \ssf\CAlg_k[W\inv]$.
		When $k \supset \QQ$, this is equivalent to the above construction.
		This works over $\ZZ$, and the free objects are not too bad, but it's hard to directly write down a simplicial commutative ring (doing so requires an infinite amount of information).
	\item We can define $\CAlg_k^{\EE_\infty}$ as above.
		This works over the sphere spectrum, but many complicated homology groups appear.
	\item Bhatt and Mathew define a category $\DAlg_k$ as follows.
		They show that $\Lbf \Sym$ extends to a monad on $\Dsf(k)$.
		Then $\DAlg_k$ is the $\infty$-category of algebras over this monad.
		This accounts for examples such as $\Rbf \Gamma(X, \Oc)$ (for a scheme $X$) but is less concrete than the other approach.
\end{enumerate}

\section*{Discussion, 6/30 (D. Arinkin) -- What is Wrong with Triangulated Categories?}

There are three problems (maybe more) with triangulated categories:
\begin{enumerate}
	\item Gluing does not work.
	\item Cones are not functorial.
	\item Categories are not well-behaved.
\end{enumerate}
Let's discuss each of these in more detail.

For gluing, suppose $X$ is a scheme.
We can consider the category of quasicoherent sheaves $\QCoh(X)$ and the corresponding derived category $\Dsf_{\mathrm{qcoh}}(X)$.
We can construct every $\Fc \in \QCoh(X)$ from sheaves $\Fc_i \in \QCoh(U_i)$ (for an open cover $\{ U_i \}$ of $X$) satisfying the cocycle condition.
However, this does not work in the derived category.

\begin{ex}
	Suppose $X = U_1 \cup U_2$, with inclusions $j_i: U_i \to X$ and $j_{12}: U_{12} \to X$.
	Then, to glue $\Fc_1$ and $\Fc_2$ along $\Fc_{12}$, we would like to let $\Fc = \cone(j_{1*} \Fc_1 \oplus j_{2*} \Fc_2 \to j_{12*} \Fc_{12})[-1]$.
	However, in the triangulated context, this cone is defined up to non-natural isomorphism.
	This can be okay for gluing along two opens, but it ruins things when we try to iterate the process and glue along more opens.
\end{ex}

The same example illustrates why non-functoriality of cones is troublesome.
When we work in the DG-context, cones are functorial and everything works well.

To see the bad categorical behavior of triangulated categories, note that we would like for suitable functors between categories of quasicoherent sheaves to correspond functorially to Fourier-Mukai transforms.

\begin{ex}
	Let $E$ be an elliptic curve.
	Then the Fourier-Mukai transform with kernel $\Oc_\Delta$ gives the identity functor.
	We can compute that $\Ext^2(\Oc_\Delta, \Oc_\Delta) \neq 0$.
	This should correspond to a natural transformation from $\id_E$ to $\id_E[2]$.
	But one can show that no such natural transformation exists when we work in the triangulated context!
\end{ex}

\section{Lecture 11, 7/3 (B. Antieau) -- Derived Stacks} 

After our setup work, we can move on to something more geometric.

\subsection{Prestacks}

Recall that the functor of points perspective lets us work intelligently with presheaves which are not necessarily representable.
Let's see how far we can take this approach.

Let $k$ be a commutative ring, and write $\DAlg_k\cn$ for $\CDga_k[W\inv]$ (when $\QQ \subset k$) or $\ssf\CAlg_k[W\inv]$ (in general).
We define the category of derived affine schemes over $k$ to be $\dAff_k = (\DAlg_k\cn)\op$.
Define the $\infty$-category of derived prestacks as
\[
	\PreStk_k = \Psh(\dAff_k) = \Fun(\dAff_k\op, \Spaces) = \Fun(\DAlg_k\cn, \Spaces).
\]
The ``stacky'' behavior of objects here (e.g.\ the fact that points may have automorphisms) comes from the fact that spaces are $\infty$-groupoids.

For any $R \in \DAlg_k\cn$, we let $\Spec R$ be the corresponding representable functor in $\PreStk_k$, i.e.\
\[
	(\Spec R)(S) = \Map_{\DAlg_k\cn}(R, S).
\]

\subsection{Topologies}

\begin{dfn}
	A map $R \to S$ in $\DAlg_k\cn$ is \emph{flat} if\footnote{Other notions of flatness do appear in the literature (e.g.\ one could ask that $\oplus_i \pi_i R \to \oplus_i \pi_i S$ is flat as a map of graded rings, but we won't use this.)}
	\begin{enumerate}
		\item The map of commutative rings $\pi_0 R \to \pi_0 S$ is flat, and
		\item The action map $\pi_i R \otimes_{\pi_0 R} \pi_0 S \to \pi_i S$ is an isomorphism for all $i \in \ZZ$.
	\end{enumerate}
\end{dfn}

The upshot is that the underlying map of commutative rings is flat and that all $\pi_i S$ are induced from $\pi_i R$ freely.

\begin{ex}
	If $R \to S$ is flat and $R$ is discrete / classical (i.e.\ $\pi_i R = 0$ for $i \neq 0$), then $S$ is discrete and flat over $R$.
\end{ex}

\begin{ex}
	The derived commutative ring $\Lbf \Sym_k (k[0])$ is flat over $k$: we have $\pi_* \Lbf \Sym_k (k[0]) = k[x]$ where $|x| = 0$.
	Note that the analogous statement is not true for the free $\EE_\infty$-ring over $\ZZ$.
\end{ex}

\begin{ex}
	The derived commutative ring $\Lbf \Sym_\QQ (\QQ[0])$ is not flat over $\QQ$, since $\pi_* \Lbf \Sym_\QQ (\QQ[0]) = \QQ[x_2]$ is not discrete.
	One possible intuition for this is that $x_2$ is an ``infinitesimal'' or ``higher nilpotent,'' though the analogy isn't complete since degree zero nilpotents don't present problems.
\end{ex}

\begin{ex}
	The identity map $R \to R$, or more generally any equivalence $R \tilde{\to} S$, is flat.
\end{ex}

\begin{ex}
	For $R \in \DAlg_k\cn$ and $f \in \pi_0 R$, we can construct a new derived commutative ring $R[1/f]$ as the (homotopy) pushout in the following square:
\[
\begin{tikzcd}
{R[x]} \rar["x \mapsto u f - 1"] \dar["x \mapsto 0"] & {R[u]} \dar \\
R \rar & {R[1/f]}
\end{tikzcd}
\]
%	\[
%		\begin{tikzcd}
%			{R[x]} \rar["x \mapsto u f - 1"] \dar["x \mapsto 0"] {R[u]} \dar \\
%			R \rar & {R[1/f]}
%		\end{tikzcd}
%	\]
	This is a homotopical version of the classical construction.
	Here (and elsewhere), we write $R[x]$ (or $R[u]$) for $\Lbf \Sym_k R[0] = (\Lbf \Sym_k k[0]) \otimes_k R$.
	Note that $R[1/f]$ is flat over $R$, and $\pi_*(R[1/f]) = (\pi_* R)[1/f]$.
	(One can justify these last few statements using a base change argument which may be discussed in the exercises.)
\end{ex}

We can lift our classical $\tau$-topologies (i.e.\ fpqc, fppf, \'etale, or Zariski) to the derived context from $\pi_0$.
Namely, the $\tau$-topology on $\dAff_k$ is generated by finite covers $\{ \Spec S_i \to \Spec R \}$ where each $R \to S_i$ is flat and $\{ \Spec \pi_0 S_i \to \Spec \pi_0 R \}$ is a classical $\tau$-cover.

\subsection{Extensions of \'etale algebras}

Let $R \in \CAlg_k$ and $I \subset R$ be a nilpotent ideal.
Then the category of $\Et_R$ of \'etale algebras over $R$ is equivalent to the category $\Et_{R/I}$ of \'etale algebras over $R/I$.
For example, every finite separable field extension over $k$ extends (uniquely, functorially, and essentially surjectively) to an \'etale algebra over $k[x]/(x^n)$.
One can think of this as being an \'etale analogue of the equivalence of $\Spec R$ and $\Spec R/I$ as non-ringed topological spaces.

\begin{thm}[Lurie]
For $R \in \DAlg_\ZZ\cn$, we have an equivalence
	\[
		\Et_R \simeq \Et_{\pi_0 R}.
	\]
\end{thm}

Thus we can construct \'etale morphisms of commutative rings from \'etale morphisms of classical rings.

\begin{ex}
	Let $R = \Lbf \Sym_\QQ (\QQ[2])$, so $\pi_* R = \QQ[x_2]$ for $|x_2| = 2$.
	We can view $R$ as a limit of its truncations, which are all nilpotent extensions of $\pi_0 R = \QQ$ (i.e.\ $R$ is ``pro-nilpotent'').
	Namely, $R = \lim_n (\tau_{\leq 2n} R$, where $\pi_* \tau_{\leq 2n} R = \QQ[x_2] / (x_2^{n+1})$.
	Thus, extending \'etale extensions of $\pi_0 R$ along each truncation successively, we should expect the above theorem of Lurie to hold.
	The underlying homotopical idea here is ``convergence of the Postnikov tower.''
	Note that the analogous statement does not hold for $\Lbf \Sym_\QQ(\QQ[0])$, as all terms are concentrated in degree zero and we cannot ``truncate higher powers away'' homotopically.
\end{ex}

\subsection{Smoothness}

\begin{dfn}
	A morphism of derived commutative rings is \emph{smooth} if it is flat and it is smooth on $\pi_0$.
\end{dfn}

Note that smooth and faithful implies fppf.

\begin{ex}
	$\Lbf \Sym_k (k[0])$ is smooth over $k$.
\end{ex}

\subsection{Faithfully flat descent}

\begin{cons}
	Let $R \to S$ be a morphism in $\DAlg_k\cn$.
	There exists an ``Amitsur'' / ``descent'' / ``\v{C}ech'' complex, i.e.\ an augmented cosimplicial diagram
	\[
		R \to S \rightrightarrows S \otimes_R S \rightarrow \dots.
	\]
	Really, $S^\bullet = \left(S \rightrightarrows S \otimes_R S \rightarrow \dots\right)$, as an object of $\csf\DAlg_k\cn = \Fun(\Delta, \DAlg_k\cn)$, is a cosimplicial object in an $\infty$-category, which takes some work to set up honestly.
\end{cons}
	
\begin{rmk}
	If $R \to S$ is faithfully flat (i.e.\ faithful on $\pi_0$ and flat), then
	\[
		R \tilde{\to} \Tot S^\bullet := \lim_\Delta S^\bullet.
	\]
	The term ``totalization'' (and the notation $\Tot$) is historically used for limits of cosimplicial objects.
	This claim follows from classical results: on $\pi_0$, this is faithfully flat descent, while for higher $\pi_i$, this follows from our definition of flatness.
\end{rmk}

\subsection{(Derived) stacks}

\begin{dfn}
	We define the \emph{category of derived stacks} $\Stk_k \subset \PreStk_k$ as the full subcategory of \emph{$\tau$-sheaves} $\Sh_\tau(\dAff_k) \subset \Psh(\dAff_k)$.
	Here $\Fc$ is a $\tau$-sheaf if, for every $\tau$-cover $\Spec S \to \Spec R$, the induced map $\Fc(R) \to \Tot \Fc(\S^\bullet)$ is an equivalence of spaces.
\end{dfn}

\begin{ex}
	Any affine derived scheme $\Spec R$ is a derived stack (for any of our $\tau$-topologies).
	To see this, note that for any $S \to T$, we get a descent complex $S \to T^\bullet$, and 
	\[
		(\Spec R)(S) \to \Tot((\Spec R)(T^\bullet))
	\]
	can be recast as
	\[
		\Hom(R, S) \to \Tot \Hom(R, T^\bullet) \simeq \Hom(R, \Tot(T^\bullet)) \simeq \Hom(R, S),
	\]
	which is an equivalence by faithfully flat descent.
\end{ex}

\begin{ex}
	Let $\Omega^\infty \Oc := \Spec k[t]$ where $|t| = 0$.
	Then
	\[
		(\Omega^\infty \Oc)(S) = \Map_{\DAlg_k\cn}(k[t], S) \simeq \Omega\infty S,
	\]
	the ``underlying space of $S$'' (this is an object of $\Spaces$).
	Here $\pi_i \Omega^\infty(S) \cong \pi_i(S)$ for all $i \geq 0$.
\end{ex}

\begin{ex}
	Let $\GL_1 := \Spec k[t^{\pm 1}]$.
	We can view $\GL_1(S)$ as the pullback
	\[
		\begin{tikzcd}
			\GL_1(S) \rar \dar & \Omega^\infty \dar \\
			\pi_0(S)^\times \rar & \pi_0 S.
		\end{tikzcd}
	\]
	Here
	\[
		\pi_i(\GL_1(S)) \cong \begin{cases}
			(\pi_0 S)^\times & i = 0 \\
			\pi_i S & i \geq 1.
		\end{cases}
	\]
\end{ex}

\begin{ex}
	Let $\GG_m(S) := \pi_0(S)^\times$.
	Then $\GG_m$ is a derived stack but is not representable or geometric in any sense.
\end{ex}

\begin{ex}
	Let $X = \Spec \ZZ[x] / (x^2)$ for $|x| = 0$.
	The pushout square
	\[
		\begin{tikzcd}
			{\ZZ[x]} \rar["x \mapsto x^2"] \dar["x \mapsto 0"] & \ZZ[x] \dar \\
			\ZZ \rar & \ZZ[x] / (x^2)
		\end{tikzcd}
	\]
	gives rise to a pullback square of derived stacks
	\[
		\begin{tikzcd}
			X(S) \rar \dar & \Omega^\infty S \dar \\
			\pt \rar & \Omega^\infty S,
		\end{tikzcd}
	\]
	where the rightmost vertical map acts by $r \mapsto r^2$ on $\pi_0$ and $s \mapsto 2s$ on $\pi_i$.
	This yields short exact sequences
	\[
		\begin{tikzcd}
			0 \rar & \frac{\pi_1 S}{2} \rar & \pi_0 X(0) \rar & \{ r \in \pi_0 S \, | \, r^2 = 0 \} \rar & 0
		\end{tikzcd}
	\]
	and
	\[
		\begin{tikzcd}
			0 \rar & \frac{\pi_{i+1} S}{2} \rar \pi_i X(S) \rar & (\pi_i)(S)[2] \rar & 0,
		\end{tikzcd}
	\]
	allowing us to compute $\pi_i X(S)$.
\end{ex}

\section{Lecture 12, 7/3 (D. Arinkin) -- Compactness and DG-Categories}

There are two main flavors of DG-categories we will consider:
\begin{itemize}
	\item Pre-triangulated Karoubian DG-categories, exemplified by $\Perf(\Asf)$.
		These are relatively ``small,'' and allow us to take cones, shifts, and direct summands.
		We like to consider arbitrary DG (quasi-)functors between such DG-categories.
	\item Cocomplete DG-categories, exemplified by $\Ind(\Asf) = \Dsf(\Asf\op)$.
		These are relatively ``large,'' and allow us to take infinite direct sums in addition to the above.
		We like to consider continuous DG (quasi-)functors between such DG-categories (i.e.\ those DG-functors that respect arbitrary direct sums and hence arbitrary direct colimits).
\end{itemize}

\begin{rmk}
	If we have cones and infinite direct sums, we can obtain arbitrary colimits.
	This is discussed in the exercises.
	The idea is that the colimit over a diagram $M: I \to \Asf$ (with $I$ a $1$-category) is given by
	\[
		\cone\left( \oplus_{\alpha \to \beta} M_\alpha \to \oplus_{\beta \in I} M_\beta \right).
	\]
	We can extend to this notion to computing geometric realizations of simplicial sets.
\end{rmk}

\subsection{A key fact}

For any DG-category $\Asf$ and any cocomplete DG-category $\Bsf$, we have
\[
	\Fun(\Ind(\Asf), \Bsf)\cont = \Fun(\Asf, \Bsf).
\]

\begin{ex}
	Let $R_1$ and $R_2$ be DG-rings.
	Note that $\Dsf(R_1) = \Ind(\Perf(R_1)) = \Ind(R_1\op)$, so
	\[
		\Fun(\Dsf(R_1), \Dsf(R_2))\cont = \Fun(R_1\op, \Dsf(R_2)) \simeq \Dsf(R_1\op \otimes R_2).
	\]
	We are cheating a bit here, involving the fact that we are working with $\Dsf$ and quasi-functors rather than $\Csf$ and functors.
	Luckily, the two ways in which we cheat cancel each other out.

	We can furthemore consider $\Dsf(R_2) = \Ind(\Perf(R_2)) = \Ind(R_2\op)$ and use this perspective to construct smaller subcategories of $\Dsf(R_1\op \otimes R_2)$ as categories of functors.
\end{ex}

\begin{ex}
	Recall that $\Ind(\Asf) = \Fun(\Asf\op, \Dsf(k))$ (since $k$ is a field, there is not much difference between $\Csf(k)$ and $\Dsf(k)$).
	Then $\Ind(\Asf) = \Fun(\Ind(\Asf\op), \Dsf(k))\cont$.
\end{ex}

\subsection{Compactly generated DG-categories}

Last time, we declared that a DG-category $\Bsf$ is compactly generated if $\Bsf \simeq \Ind(\Asf)$ for some $\Asf$.

We would like to disentangle the terms ``compact'' and ``generation'' here.
Let $\Bsf$ be a cocomplete DG-category.

\begin{dfn}
	An object $x \in \Bsf$ is compact if $\Hom_\Bsf(x, -)$ respects (infinite) direct sums.
	That is, the natural map
	\[
		\oplus_\alpha \Hom(x, x_\alpha) \to \Hom\left(x, \oplus_\alpha x_\alpha\right)
	\]
	is a qiso.
	Note that $\Hom_\Bsf(x, -)$ always respects infinite direct products (when they exist).
	One can think of ``compactness'' as meaning that every map from $x$ to an infinite direct sum always factors (up to qiso) as a map to a finite subsum.
\end{dfn}

\begin{rmk}
	In the abelian category $R\Mod^\heartsuit$:
	\begin{itemize}
		\item $\Hom(M, -)$ respects infinite direct sums if $M$ is finitely generated.
		\item $\Hom(M, -)$ respects filtered colimits if $M$ is finitely presented.
	\end{itemize}
	In a cocomplete DG-category, these notions coincide.
\end{rmk}

\begin{prop}
	Let $\Asf$ be a DG-category and $F \in \Dsf(\Asf)$.
	Then $F$ is compact if and only if $F$ is perfect.
\end{prop}

The proof is left as an exercise.

If $\Bsf$ is compactly generated, then $\Bsf \simeq \Ind(\Bsf^c)$, where $\Bsf^c$ is the full subcategory of compact objects of $\Bsf$.
This explains the name!

\begin{rmk}
	Suppose $\Bsf \simeq \Ind(\Asf)$.
	We have
	\[
		\Hom_\Bsf\left(\oplus_\alpha x_\alpha, \oplus_\beta x'_\beta)\right) = \prod_{\alpha} \Hom\left(x_\alpha, \oplus_\beta x'_\beta)\right).
	\]
	If $x_\alpha, x'_\beta \in \Asf$ for all $\alpha, \beta$, then this becomes
	\[
		\prod_\alpha \oplus_\beta \Hom_\Asf(x_\alpha, x'_\beta),
	\]
	so we can think of a homomorphism as an infinite matrix with only finitely many nonzero entries in each column.
\end{rmk}

\begin{cor}
	Let $\Asf$ be a DG-category, $\Bsf$ a cocomplete DG-category, and $F: \Asf \to \Bsf$ a DG-functor.
	Write $\tilde{F}: \Ind(\Asf) \to \Bsf$ for the corresponding continuous DG-functor.
	Suppose that $F$ is (quasi-)fully faithful and that $F(\Asf) \subset \Bsf^c$.
	Then $\tilde{F}$ is also (quasi-)fully faithful.
	Moreover, $\tilde{F}$ is an equivalence if and only if $\Asf^\perp = 0$ (i.e.\ if $x \in \Bsf$ and $\Hom(F(y), x)$ is acyclic for all $y \in \Asf$, then $x \simeq 0$).
\end{cor}

We can reformulate the former statement as follows.
Let $\Bsf$ be cocomplete and $\Asf \subset \Bsf^c$ a full subcategory.
Then $\Ind(\Asf)$ is a full subcategory of $\Bsf$ (the full cocomplete subcategory generated by $\Asf$).

\begin{ex}
	Let $\Bsf$ be a cocomplete DG-category and $x \in \Bsf$.
	Then the DG-ring $R = \End_\Bsf(x)$ gives a full subcategory $\Asf$ of $\Bsf$ (the full subcategory with one object, namely $x$).
	This extends to a continuous functor $\Ind(\Asf) = \Dsf(R\op) \to \Bsf$, given by $- \otimes_R x$.
	If $x$ is compact, this functor is fully faithful.
\end{ex}

\begin{ex}
	The claim about equivalences in the Corollary above gives $\Ind(\Asf) \simeq \Ind((\Asf\pretr)\Kar)$.
\end{ex}

\begin{ex}
	Let $\Ob \Asf = \{ x_1, \dots, x_n \}$.
	Then $\Ind(\Asf)$ is generated by the compact object $x_1 \oplus \dots x_n$.
	Letting $R = \End(x_1 \oplus \dots x_n)$, we obtain $\Ind(\Asf) \simeq \Dsf(R\op)$.
\end{ex}

\section*{Discussion, 7/3 (B. Antieau) -- Ring Structure on $H_\bullet(\CC\PP^\infty, \QQ)$}

How can we explicitly compute the ring structure on $H_\bullet(\CC\PP^\infty, \QQ)$?

Note that $\CC\PP^\infty \simeq BS^1 \simeq K(\ZZ, 2)$, and $\CC\PP^\infty$ has a product map $\CC\PP^\infty \times \CC\PP^\infty \to \CC\PP^\infty$ (corresponding to the tensor product of complex line bundles).\footnote{If one wants to work strictly, one can view $B^2 \ZZ$ as a simplicial object and consider the codiagonal map.}
As an algebra, we have 
\[
	C_\bullet(\CC\PP^\infty, \QQ) \simeq \QQ \otimes_{C_\bullet(S^1, \QQ)} \QQ.
\]
(using the derived tensor product of algebras here).
Let's explain why.

How do we compute $R \otimes_T S$, the pushout in $\DAlg_k\cn$?
We can understand this as the geometric realization of
\[
	\dots \to R \otimes_k T \otimes_k S \rightrightarrows R \otimes_k S,
\]
i.e.\ the geometric realization of the simplicial derived commutative ring $(R \otimes_k T^\bullet \otimes_k S)$ (induced by the bar construction).
In general, this argument shows that any $\infty$-category $\Csf$ with finite coproducts and geometric realizations has pushouts.
The bar construction can also be used to construct $BG$ as the geometric realization of the simplicial object $B_\bullet G = \pt \times G^\bullet \times \pt$.

We can obtain the algebra structure via the fold maps $T \sqcup T \to T$.
In particular, we have
\[
	C_\bullet(BS^1, \QQ) \simeq C_\bullet(|B_\bullet S^1|, \QQ) \simeq |C_\bullet(B_\bullet S^1, \QQ)| \simeq |C_\bullet(BS^1, \QQ)^{\otimes \bullet}| \simeq \QQ \otimes_{C_\bullet(S^1, \QQ)} \QQ.
\]
This gives one way of computing $C_\bullet(BS^1, \QQ)$.

An alternative approach is to view $\Lbf \Sym_\ZZ(\ZZ[2])$ as a divided power algebra on a degree two generator.
Yet another way is to try to use the cell structure on $\CC\PP^\infty$.

\section{Lecture 13, 7/5 (D. Arinkin) -- $\QCoh(X)$ as a DG-category}

Last time, we discussed compactly generated DG-categories.
Recall that, for a cocomplete DG-category $\Bsf$, an object $x \in \Bsf$ is compact if and only if $\Hom_\Bsf(x, -)$ is continuous (i.e.\ commutes with arbitrary colimits, or equivalently commutes with direct sums).
Given any DG-category $\Asf$, we can construct a cocomplete, compactly generatedDG-category $\Ind(\Asf)$.
Conversely, given a cocomplete DG-category $\Bsf$, we obtain a pre-triangulated, Karoubian DG-category $\Bsf^c$ consisting of compactly generated objects of $\Bsf$.
Thus we obtain an equivalence between pre-triangulated, Karoubian DG-categories and cocomplete, compactly generated DG-categories.

If $\Bsf$ is cocomplete, then we say $\Asf \subset \Bsf^c$ generates $\Bsf$ if $\Asf^\perp = 0$.
In this case, the natural map $\Ind(\Asf) \to \Bsf$ is an equivalence.
Furthermore, we obtain $\Bsf^c = (\Asf\pretr)\Kar$, i.e.\ $\Bsf^c$ can be obtained from $\Asf$ by taking cones and direct summands.
Conversely, if $\Bsf$ is compactly generated, then any $\Asf \subset \Bsf^c$ with $\Bsf^c = (\Asf\pretr)\Kar$ generates $\Bsf$.

\subsection{$\QCoh(X)$}

We are interested in studying the (derived) category of quasicoherent sheaves $\QCoh(X)$ on a scheme $X$.
One classical construction of this is as the derived category of an abelian category $\QCoh(X)^\heartsuit$ (objects of which are constructed by gluing along affines).
This works fine for nice schemes but doesn't behave well in general.

A better construction is to take the derived category of arbitrary $\Oc_X$-modules and then restrict to the full subcategory of objects with quasicoherent cohomology.
This solves some problems with the other approach: 
\begin{itemize}
	\item $\QCoh(X)^\heartsuit$ typically doesn't have enough projectives (more generally, ``nice'' resolutions by quasicoherent sheaves may not exist).
	\item Injectives in $\QCoh(X)^\heartsuit$ are not a priori injective as sheaves (leading to some question of how to define sheaf cohomology -- whether to use the derived pushforward of $\QCoh(X)$ or $\Sh(X)$).
\end{itemize}

If we work with DG-categories, we can actually define $\QCoh(X)$ directly by gluing.

\begin{dfn}
	For a (derived) prestack $X$, we define
	\[
		\QCoh(X) = \lim_{\Spec R \to X} \Dsf(R).
	\]
\end{dfn}

If $X$ is a scheme, it suffices to take the limit over affine opens $\Spec R \subset X$ (so in particular, when $X$ is classical, we only need to consider classical rings $R$).
The limit appearing here is a limit of (cocomplete) DG-categories which is indexed by an $\infty$-category.

\begin{ex}
	If $X$ is a quasicompact separated scheme, then we can write $X = \cup_{i=1}^n U_i$ with each $U_i = \Spec R_i$ affine and all intersections also affine.
	An object $\Fc \in \QCoh(X)$ is specified by:
	\begin{enumerate}
		\item A collection $\Fc_i \in \QCoh(U_i) = \Dsf(R_i)$.
		\item A collection of quasi-isomorphisms $\Fc_i |_{U_i \cap U_j} \tilde{\to} \Fc_j |_{U_i \cap U_j}$ in $\Dsf(R_{ij})$.
		\item Further compatibilities of these isomorphisms (chain homotopies and higher homotopies) on triple intersections, quadruple intersections, etc.
	\end{enumerate}
	For $X$ quasicompact, this process terminates after taking finitely many intersections (but can still be annoying).
\end{ex}

\begin{ex}
	Suppose $X = U \cup V$.
	Then the limit definition lets us write
	\[
		\QCoh(X) = \QCoh(U) \times_{\QCoh(U \cap V)} \QCoh(V).
	\]
	Thus an object of $\QCoh(X)$ is given by a pair of objects of $\QCoh(U)$ and $\QCoh(V)$ together with a quasi-isomorphism of the restrictions to $\QCoh(U \cap V)$.
	One can compute $\Hom$ in this category using the \v{C}ech complex.
\end{ex}

\subsection{Compact generation of $\QCoh(X)$}

We can apply the above arguments to understanding compact objects in $\QCoh(X)$.

\begin{dfn}
	An object $\Fc \in \QCoh(X)$ is perfect if $\Fc|_{\Spec R}$ is perfect for all $\Spec R \to X$.
	(It suffices to check this property on an open cover of $X$.)
\end{dfn}

\begin{cor}
	Let $X$ be a quasicompact separated scheme.
	Then
	\[
		(\QCoh(X))^c = \Perf(X).
	\]
\end{cor}

The key idea here is that we can compute $\Hom$ using the \v{C}ech complex, and that in this case infinite direct sums and finite products commute.

We would like to generally understand when $\QCoh(X)$ is compactly generated.
This is important and not immediate from the definitions (limits of compactly generated DG-categories need not be compactly generated).

Note that, for $X = U \cup V$, we always have
\[
	\QCoh(X) = \QCoh(U) \times_{\QCoh(U \cap V)} \QCoh(V) \textrm{ and } \Perf(X) = \Perf(U) \times_{\Perf(U \cap V)} \Perf(V).
\]
However, this tells us nothing about whether the latter category generates the former.

One of the first affirmative answers to the question of compact generation is the following.

\begin{thm}[Thomason-Trobaugh]
	If $X$ is a quasicompact and separated scheme, then $\Perf(X)$ generates $\QCoh(X)$.
\end{thm}

\begin{proof}
	By induction, we can reduce to the case $X = U \cup V$ where $U$ and $U \cap V$ are ``perfect'' (i.e.\ satisfy the conclusions of the theorem) and $V$ is affine.
	The outline is as follows.
	\begin{enumerate}
		\item Take generators $\Fc_\alpha \in \Perf(U)$.
			(If $U$ is affine, we can just take $\Fc = \Oc_U$.)
			Extend these generators to $\tilde{\Fc}_\alpha \in \Perf(X)$.
			This is a technical process and can be done in a weak sense that suffices for the purposes of the proof.
		\item The $\tilde{\Fc}_\alpha$'s should generate $\Perf(X)$ ``modulo'' sheaves supported on $Y := X \setminus U$.
			Note that $Y$ is closed in $V$.
			So take enough perfect objects $\Gc_\beta$ of 
			\[
				\QCoh(V)_Y = \{ \Fc \in \QCoh(V) \, | \, \Fc_{U \cap V} = 0 \}
			\]
			to generate $\QCoh(V)_Y$.
			If $Y = \{ f_1 = \dots = f_k = 0 \}$, then we can take $\Gc$ to be the complex $\bigotimes_{i=1}^k (f_i: \Oc_V \to \Oc_V)$.
			Extend these to $\tilde{\Gc}_\alpha \in \Perf(X)$ such that $\tilde{\Gc}_\alpha|_U = 0$.
		\item The collection $\{\tilde{\Fc}_\alpha\} \cup \{\tilde{\Gc}_\beta\}$ generates $\QCoh(X)$.
			This is comparatively easy to show.
	\end{enumerate}
\end{proof}

\section{Lecture 14, 7/5 (B. Antieau) - More on derived stacks}

Recall that the category of derived stacks (for the $\tau$-topology) is defined as $\Stk_k = \Sh_\tau(\dAff_k)$.

\subsection{Homotopy sheaves}

Given a derived stack $X$, we can consider the assignment $R \mapsto \pi_0(X(R))$, which gives a presheaf of sets on $\dAff_k$.
Write $\pi_0^\tau(X)$ for the sheafification of this presheaf.
To capture higher homotopy groups, fix a point $x: \Spec k \to X$ and consider the assignments $R \mapsto \pi_i(X(R), x)$ (where we precompose the map $x$ with the structure map $\Spec R \to \Spec k$).
This yields a presheaf which we sheafify to gain sheaves of groups $\pi_i^\tau(X, x)$ (in fact, sheaves of abelian groups for $i \geq 2$).

\begin{ex}
	Recall that we defined $\Omega^\infty \Oc (R) = \Omega^\infty R$, the ``underlying space / homotopy type'' of $R$.
	Here $\pi_i(\Omega^\infty R, 0) \simeq H_i(R)$, so
	\[
		\pi_i^\tau(\Omega^\infty \Oc)(R) = H_i(R) = \pi_i(R).
	\]
\end{ex}

\begin{ex}
	For $\GG_m(R) = (\pi_0 R)^\otimes$, we get $\pi_0^\tau \GG_m = \GG_m$ and $\pi_i^\tau \GG_m = 0$ for $i > 0$.
\end{ex}

\begin{ex}
	For $\GL_1 = \Spec \ZZ[t^{\pm 1}]$, the pullback diagram
	\[
		\begin{tikzcd}
			\GL_1(R) \rar \dar & \Omega^\infty R \dar \\
			(\pi_0 R)^\times \rar & \pi_0 R
		\end{tikzcd}
	\]
	gives $\pi_0^\tau \GL_1 (R) = \GG_m(R)$ and $\pi_i^\tau \GL_1(R) = \pi_i\Omega^\infty \Oc$ for $i \geq 0$.
\end{ex}


\subsection{Derived stacks and classical stacks}

Recall that we have an adjunction
\[
	\DAlg_k\cn \leftrightarrows \CAlg_k.
\]
Passing to opposites, we get an adjunction
\[
	\iota: \Aff_k \leftrightarrows \dAff_k : \Spec \pi_0.
\]

We can obtain a further adjunction between ``higher stacks'' (i.e.\ $\HStk = \Sh_\tau(\Aff_k)$) and derived stacks (i.e.\ $\Stk_k$).
Namely, $\iota$ induces a ``classical locus'' functor 
\[
	\iota^* = (-)\cl : \HStk_k \to \Stk_k,
\]
given by $X\cl(R) = X(R)$, where $X\cl$ is only defined on discrete commutative rings.
The functor $(-)\cl$ admits both a left adjoint $\iota_*$ and a right adjoint $\iota_!$.
Here $\iota_*$ is defined on a derived commutative ring $R$ by
\[
	(\iota_* X)(R) = X(\pi_0 R)
\]
The left Kan extension $\iota_!$ is defined on a discrete commutative ring by
\[
	\iota_! (R) = X(R) 
\]
and is extended to derived commutative rings by taking colimits.

\begin{ex}
	\[
		\GG_m\cl \simeq \GL_1\cl \simeq \GG_m^\heartsuit,
	\]
	where the latter is $\GG_m$ viewed as a higher stack.
\end{ex}

\begin{ex}
	\[
		(\Spec R)\cl \simeq \Spec \pi_0 R.
	\]
\end{ex}

\begin{ex}
	One can compute using adjunctions that
	\[
		(\iota_* \Spec R)(\Spec S) = \Hom(R, \pi_0 S).
	\]
\end{ex}

\begin{dfn}
	A derived stack $X$ is \emph{classical} if $\iota_! X\cl \tilde{\to} X$.
\end{dfn}

\begin{ex}
	The derived stack $\GL_1 = \Spec \ZZ[t^{\pm 1}]$ is classical, even though it has higher homotopy sheaves when viewed as an object of $\Stk_k$.
	The idea is that derived commutative rings can have interesting homotopies between units.
	Due to this and similar phenomena, one should be careful when taking homotopy sheaves (doing so is not really a ``geometric'' operation).
\end{ex}

\subsection{Geometric (derived) stacks: desired properties}

We would like to find a collection of ``nice'' objects in $\Stk_k$.
By ``nice,'' we mean:
\begin{enumerate}
	\item Affines $\Spec R$ are nice.
	\item $\tau$-locally affine stacks should be nice.
	\item Quotients by group schemes of nice stacks should be nice.
\end{enumerate}

\subsection{Algebraic spaces}

Let $\tau$ be the \'etale topology.
The slogan to remember for algebraic spaces is that a scheme is to the Zariski topology as an algebraic space is to the \'etale topology.
Thus, one should view an algebraic space as being ``\'etale locally affine.''

\begin{dfn}
	A derived stack $X$ is a \emph{derived algebraic space with affine diagonal} (DASAD) if there exists a surjection $\coprod_i \Spec S_i \to X$ such that, for any $\Spec R \to X$, the pullback $P = (\coprod_i \Spec S_i) \times_X \Spec R$ is $\Spec T$ for an \'etale $R$-algebra $T$.
	Each $\Spec S_i \to X$ should be thought of as ``\'etale and affine.''
	For surjectivity, recall first that a map of sheaves of sets $Y \to X$ is surjective if for all $x \in X(U)$, there exists a cover $V \to U$ such that $x|_V \in X(V)$ lifts to $Y(V)$.
	The same definition works for sheaves of spaces (i.e.\ derived stacks): a map $Y \to X$ of derived stacks is surjective if $\pi_0^\tau Y \to \pi_0^\tau X$ is surjective.
\end{dfn}

\begin{rmk}
	This definition of surjectivity is related to a remarkable property of $\Spaces$: given $Y \to X$ in $\Spaces$, if we take the \v{C}ech cover $Y_\bullet \to X$ where $Y_\bullet$ is the simplicial object given degreewise by $Y \times_X Y \times_X \dots \times_X Y$ (starting from $Y_0 = Y$), then $|Y_\bullet| \to X$ is an equivalence if and only if $\pi_0 Y \to \pi_0 X$ is an equivalence.
	The result here is known as ``effectivity of groupoids.''
\end{rmk}

\begin{ex}
	A separated classical scheme $X$ is a DASAD.
\end{ex}

\begin{dfn}
	A morphism $X \to Y$ in $\Stk_k$ is a \emph{relative DASAD} (i.e.\ RDASAD) if, for all $\Spec R \to Y$, the pullback $X \times_Y \Spec R$ is a DASAD.
\end{dfn}

\begin{dfn}
	A morphism $X \to \Spec S$ in $\Stk_k$ is an \emph{\'etale derived algebraic space} over $\Spec S$ if there is a surjection $\coprod_i \Spec S_i \to X$ such that
	\begin{enumerate}
		\item Each $S_i$ is \'etale over $S$.
		\item Each $\Spec S_i \to X$ is a RDASAD.
	\end{enumerate}
\end{dfn}

\begin{dfn}
	A morphism $X \to Y$ in $\Stk_k$ is \emph{representable \'etale} if, for all $\Spec R \to Y$, the pullback $X \times_Y \Spec R$ is an \'etale algebraic space over $\Spec R$.
\end{dfn}

\begin{dfn}
	A \emph{derived algebraic space} (DAS) is an object $X \in \Stk_k$ such that there exists a surjection $\coprod_i \Spec S_i \to X$ where each $\Spec S_i \to X$ is representable \'etale.
\end{dfn}

\begin{dfn}
	A morphism $X \to Y$ in $\Stk_k$ is a relative derived algebraic space if, for all $\Spec R \to Y$, the pullback $X \times_Y \Spec R$ is a DAS.
\end{dfn}

\begin{dfn}
	A DAS $X$ is smooth over $\Spec k$ if there exists a surjection $\coprod_i \Spec S_i \to X$ such that each $\Spec S_i \to X$ is representable \'etale and each $S_i$ is a smooth $k$-algebra.
\end{dfn}

The reason we need so many definitions is due to the fact that not everything is separable.

\begin{rmk}
	Let $X \in \Stk_k$ be a DAS and $R \in \CAlg_k$.
	Then $X(R)$ is a set.
	(If we take $R$ to be a derived commutative ring, we may get higher homotopy groups, but those would really be coming from $R$ rather than $X$ itself.)
\end{rmk}

The classical locus of a derived algebraic space is a classical algebraic space.

\subsection{$B_\tau G$}

Suppose $G$ is an algebraic group scheme over $k$.
We would like to say that $B_\tau G$, the stack of $\tau$-locally trivial principal $G$-torsors, is geometric.
For $G$ smooth, this will be the Platonic example of an Artin stack.

A $G$-torsor is a map $Y \to X$ which is $G$-equivariant (for some $G$-action on $Y$ and the trivial $G$-action on $X$) such that the natural map $G \times Y \to Y \times_X Y$ (given by $(g, y) \mapsto (gy, y)$) is an equivalence.
If fix $x \in X$ and consider a point $y \in Y_x$ of the fiber, this map gives an equivalence $G \simeq Y_x$.
The ``$\tau$-locally trivial'' condition here means that there exists a $\tau$-cover $U \to X$ such that $G \times U \tilde{\to} Y \times_X U$ gives a $G$-equivariant equivalence.
Note that the topology $\tau$ matters here -- different $\tau$ will give different answers.

We have $H^1_\tau(X, G) = \pi_0(B_\tau G(X))$ and $H^0_\tau(X, G) = \pi_1(B_\tau G(X)) \simeq G(X)$.

One can also interpret $B_\tau G = \pt / G$ (similarly to the construction of homotopy quotients of topological spaces).
In the setting of derived stacks, one can consider the presheaf of spaces $R \mapsto B(G(R))$.
We define $B_\tau G$ as the $\tau$-sheafification of this presheaf.

\subsection{Geometric derived stacks}

\begin{dfn}
	\begin{enumerate}
		\item A \emph{relative $0$-stack} is a relative DAS $X \to Y$.
			This is furthermore \emph{smooth} if the fibers are smooth.
		\item A \emph{relative $n$-stack} is a morphism $X \to Y$ in $\Stk_k$ such that, for all $\Spec R \to Y$, the pullback $P = X \times_Y \Spec R$ admits a surjection $\coprod_i \Spec S_i \to P$ which is a smooth relative $(n-1)$-stack.
			This is furthermore \emph{smooth} if we can choose the $S_i$ to be smooth over $R$.
		\item An \emph{$n$-stack} is a relative $n$-stack over $\Spec k$.
	\end{enumerate}
\end{dfn}

\begin{ex}
	\begin{enumerate}
		\item $B\GL_1$ is a smooth $1$-stack.
		\item If $G$ is a smooth affine group scheme and $G \curvearrowright X = \Spec R$, then $X / G$ is a $1$-stack which is smooth if $X$ is.
		\item $B^n \GL_1$ is a smooth $n$-stack.
	\end{enumerate}
\end{ex}

\begin{rmk}
	We have
	\[
		\pi_1^{\acute{e}t} B^n \GL_1 = \begin{cases}
			0 & i < n \\
			\GG_m & i = n \\
			\pi_{i-n} \Omega^\infty \Oc & i > n.
		\end{cases}
	\]
	Also $(B^n \GL_1)\cl \simeq K(\GG_m^\heartsuit, n)$.
\end{rmk}

\section*{Discussion, 7/5 (Multiple Presenters)}

\subsection{J. Mundinger -- ring structure on $H_\bullet(\CC\PP^\infty)$}

Here's a way to compute the ring structure on $H_\bullet(\CC\PP^\infty, \ZZ)$.
We will assume as known the following:
\begin{itemize}
	\item $H^\bullet(\CC\PP^\infty, \ZZ) \cong \ZZ[c]$ where $|c| = 2$.
	\item $\CC\PP^\infty = BS^1$.
\end{itemize}

Recall that we have a group structure on $\CC\PP^\infty$ given by
\[
	\nabla: BS^1 \times BS^1 \tilde{\to} B(S^1 \times S^1) \to BS^1.
\]
Viewing $BS^1$ as classifying complex line bundles, $\nabla$ is given (up to homotopy) by the tensor product of line bundles.

To compute the action of $\nabla$ on homology, note that the dual map on homology is given by
\begin{align*}
	\nabla^*: H^2(\CC\PP^\infty, \ZZ) &\to H^2(\CC\PP^\infty \times \CC\PP^\infty, \ZZ)
	c &\mapsto c \otimes 1 + 1 \otimes c.
\end{align*}
This comes from the formula for Chern classes of tensor products: 
\[
	c_1(L \otimes L') = c_1(L) + c_1(L').
\]

Note that $H^{2n}(\CC\PP^\infty, \ZZ)$ is generated by $c^{2n}$.
Let $(c^n)^\vee$ be the dual generator of $H_{2n}$.
We note
\begin{align*}
	\ip{\nabla_*^{n-1} (c^\vee \otimes \dots \otimes c^\vee)}{c^n} &= 
	\ip{c^\vee \otimes \dots \otimes c^\vee}{(\nabla^*)^{n-1}c^n} \\
	&= \ip{c^\vee \otimes \dots \otimes c^\vee}{(c \otimes 1 \otimes \dots \otimes 1) + \dots + (1 \otimes \dots \otimes 1 \otimes c^\vee)}
	&= n!.
\end{align*}
Therefore $(c^\vee)^n = n! (c^n)^\vee$, so our homology ring is a divided power algebra.

\subsection{D. Arinkin -- More on $\QCoh$}

Let $X$ be a scheme.
How can we connect our definition of $\QCoh(X)$ (as a homotopy limit) to $\Dsf_{qc}(X)$, the derived category of sheaves on $X$ with quasicoherent cohomology?

An object $\Fc$ in $\QCoh(X)$ is given by:
\begin{enumerate}
	\item Objects $\Fc_R \in \Dsf(R)$ for every $\Spec R \to X$
	\item Quasi-isomorphisms $R' \otimes_{R''} \Fc_{R''} \tilde{\to} \Fc_{R'}$ for every $\Spec R'' \to \Spec R'$
	\item Higher homotopies, et cetera...
\end{enumerate}

Similarly, to define a (non-derived) $\Oc_X$-module on $X$, we specify the sheaf on open affines by:
\begin{enumerate}
	\item Objects $M_R \in (\Mod_R)^\heartsuit$
	\item Morphisms $R' \otimes_{R''} M_{R''} \to M_{R'}$, etc.
\end{enumerate}
We end up with a lax limit rather than a true limit (since the morphisms are not required to be isomorphisms).

\subsection{D. Arinkin and B. Antieau -- A derived category which does not come from an abelian category}

Consider the DG-category of $\CC$-local systems on $S^2$.
One can define this as
\[
	\Loc(S^2) = \lim_{U \subset S^2} \Loc(U) = \Fun(S^2, \Dsf(\CC)).
\]
The corresponding abelian category is $\Vect^\heartsuit$ (because $\pi_1(S^2)$ is trivial).
However, $\Loc(S^2)$ is not trivial -- one can compute $\Hom_{\Loc(S^2)}(\ul{\CC}, \ul{\CC}) = C^*(S^2; \CC)$, so we have a nontrivial $\Ext^2(\ul{\CC}, \ul{\CC})$.
Thus looking only at the abelian category loses a lot of information.

One can interpret $\Vect^\heartsuit$ as the heart of a t-structure on $\Loc$ (induced by the standard t-structure on $\Dsf(\CC)$).
We then obtain 
\[
	\Fun(S^2, \Dsf(\CC)^\heartsuit) = \Fun(\Ho(S^2), \Dsf(\CC)^\heartsuit) = \Fun(\tau_{\leq 1} S^2, \Dsf(\CC)^\heartsuit) = \Dsf(\CC)^\heartsuit.
\]
This t-structure approach can also be used to understand the relationship between $\QCoh(X)$ and $\Dsf_{qc}(X)$.

\section{Lecture 15, 7/6 (B. Antieau) -- The Cotangent Complex}

We would like to prove that some stacks of interest are ``geometric.''

\begin{thm}
	Let $X$ be a geometrically connected smooth proper scheme over $k$.
	Then $\ul{\Pic}_{X/k}$, the stack of line bundles on $X$, is a $1$-stack.
	Furthermore, the cotangent complex at a point $\Lc$ is $\Rbf \Gamma(X, \Oc_X)^\vee[-1]$.
\end{thm}

Here $\ul{\Pic}_{X/k}$ is defined on a derived commutative ring $R$ by
\[
	\ul{\Pic}_{X/k}(R) \simeq \Pic(\Dsf(X_R)),
\]
where the latter indicates the collection of invertible objects in $\Dsf(X_R)$.

The above theorem implies that the cotangent complex is concentrated in cohomological degrees $[-1, d-1]$ for $d = \dim (X / k)$).
The $-1$ degree here captures the stackiness of $\ul{\Pic}_{X/k}$, while the positive degree terms capture derived structure.

\begin{cor}
	If $H^i(X, \Oc_X) \neq 0$ for some $i \geq 3$, then $\ul{\Pic}_{X/k}$ is not classical.
\end{cor}

This corollary might also hold for $i = 2$, but the proof would be harder.
We can recover the classical Picard stack as $(\ul{\Pic}_{X/k})\cl$.

\subsection{K\"ahler differentials}

To understand the above theorem, we must first understand the cotangent complex.
We begin by recalling the theory of K\"ahler differentials.

\begin{dfn}
	Let $k \to R$ be a map of classical commutative rings.
	A \emph{$k$-derivation} of $R$ into an $R$-module $M$ is a function $d: R \to M$ such that
	\begin{enumerate}
		\item $d(r + s) = d(r) + d(s)$
		\item $d(rs) = s d(r) + r d(s)$
		\item $d(\lambda) = 0$ for all $\lambda \in k$.
	\end{enumerate}
	These form an $R$-module $\Der_k(R, M)$.
	There exists a universal $k$-derivation $R \to \Omega^1_{R/k}$ such that
	\[
		\Hom(\Omega^1_{R/k}, M) \cong \Der_k(R, M)
	\]
	for all $R$-modules $M$.
\end{dfn}

\begin{ex}
	If $k \to R$ is surjective, then $\Omega^1_{R/k} = 0$.
\end{ex}

\begin{ex}
	\[
		\Omega^1_{k[x]/k} = k[x] dx.
	\]
\end{ex}

\begin{ex}
	Letting $I = \ker(R \otimes_k R \to R)$, we have $\Omega^1_{R/k} \cong I / I^2$ via $a db \mapsto a \otimes b - ab \otimes 1$.
\end{ex}

\subsection{Infinitesimal liftings}

Let $\CAlg_{k//R} = (\CAlg_k)_{/R}$, the category of classical commutative $k$-algebras equipped with a map to $R$.

For an $R$-module $M$, one can define an algebra structure on $R \oplus M$ via the action of $R$ on $M$ (setting $M \cdot M = 0$).
We call this the \emph{trivial square-zero extension} of $R$ by $M$.
This satisfies
\[
	\Hom_{\CAlg_{k//R}}(R, R \oplus M) \cong \Der_k(R, M) \cong \Hom_R(\Omega^1_{R/k}, M).
\]

\begin{ex}
	The dual numbers $R[x] / (x^2)$ give a trivial square-zero extension of $R$.
\end{ex}

\begin{ex}
	The ring $\ZZ / p^2 \ZZ$ is not a trivial square-zero extension of $\ZZ / p \ZZ$.
\end{ex}

A general \emph{square-zero extension} $\tilde{S} \to S$ is defined by the condition that, if $I = \ker(\tilde{S} \to S)$, then $I^2 = 0$.
The set of $k$-algebra lifts of $R \to S$ to $R \to \tilde{S}$ is a $\Der_k(R, I)$-torsor, i.e.\ is either empty or has a free transitive $\Der_k(R, I)$-action.
The action here is just by $\phi \mapsto \phi + d$ for $\phi$ a lift and $d$ a derivation.

\subsection{The cotangent complex}

\begin{dfn}[Quillen-Illusie]
	Let $R \in \DAlg_k\cn$, and write $R = |R_\bullet|$ for $R_\bullet$ a simplicial commutative ring with each $R_i$ polynomial (in possibly infinitely many variables).
	Define the \emph{cotangent complex} of $R$ over $k$ as $\LL_{R/k} = \Omega^1_{R_\bullet/k} \otimes_{R^\bullet} R$.
	This is a simplicial $R$-module, and we can take the geometric realization to view it as an object of $\Dsf(R)_{\geq 0}$.
\end{dfn}

This gives an explicit construction, but we can also give more abstract definitions that ``get to the heart of things.''

\begin{cons}
	Recall $\DAlg_k \simeq \Psh_\Sigma(\Polyfp_k)$.
	\begin{enumerate}
		\item Consider the diagram
			\[
				\begin{tikzcd}
					\Polyfp_k \rar["R \mapsto \Omega^1_{R/k}"] \dar[hook] & \Dsf(k)_{\geq 0} \\
					\Psh_\Sigma(\Polyfp_k). \ar[ur, dashed]
				\end{tikzcd}
			\]
			Here we obtain $\LL_{-/k}$ as the left Kan extension of $\Omega^1$.
			Note that this only produces the $k$-module structure on $\LL_{-/k}$!
			We want an $R$-module structure.
		\item A smarter variation of this comes from looking at the diagram
			\[
				\begin{tikzcd}
					& \Dsf(-)_{\geq 0} \dar & \Dsf(R)_{\geq 0} \lar \dar \\
					\Polyfp_k \ar[ur] \rar & \DAlg_k\cn & \pt \lar["R"]
				\end{tikzcd}
			\]
			where the right square is a pullback square, and $\Dsf(-)_{\geq 0}$ is constructed using ``straightening-unstraightening'' (similar to the Grothendieck construction for turning a stack into a fibered category).
			Objects of $\Dsf_{\geq 0}$ are given by pairs $(R \in \DAlg_k\cn, M \in \Dsf(R))$ with morphisms $(R, S) \to (M, N)$ given by pairs $(R \to S, S \otimes_R M \to N)$.
			The diagonal arrow is $R \mapsto (R, \Omega^1_{R/k})$.
			In this context, $\LL_{-/k}$ is defined as the left Kan extension of $\Polyfp_k \to \Dsf(-)_{\geq 0}$ along the map to $\DAlg_k\cn$.
	\end{enumerate}
\end{cons}

It is immediate from this construction that $\LL_{-/k}$ preserves sifted colimits.
It preserves all colimits if and only if $\Omega^1_{-/k}$ preserves all colimits in $\Polyfp_k$.
This latter hypothesis is true, as one can show in the exercises.
(Note that colimits in $\Dsf(-)_{\geq 0}$ are given by $(R, M) \coprod (S, N) = (R \otimes_k S, (M \otimes_k S) \oplus (R \otimes_k N))$.)
Therefore:

\begin{prop}
	The functor $\LL_{-/k}$ preserves all colimits.
\end{prop}

\begin{ex}
	Let $R = k[x] / x^2$.
	We can present $R$ as the pushout
	\[
		\begin{tikzcd}
			k[y] \rar["y \mapsto x^2"] \dar["y \mapsto 0"] & k[x] \dar \\
			k \rar & R.
		\end{tikzcd}
	\]
	Here $\LL_{k[y]/k} = k[y] dy$, $\LL_{k[x]/k} = k[x] dx$, and $\LL_{k/k} = 0$.
	Thus we have a pushout square of cotangent complexes
	\[
		\begin{tikzcd}
			R dy \rar["dy \mapsto 2x dx"] \dar & R dx \dar \\
			0 \rar & \LL_{R/k}.
		\end{tikzcd}
	\]
	If $2$ is invertible in $k$, we obtain
	\[
		H_i(\LL_{R/k}) = \begin{cases}
			k & i = 0, 1 \\
			0 & \textrm{otherwise.}
		\end{cases}
	\]
\end{ex}

\subsection{Square-zero extensions}

We can also understand cotangent complexes using square-zero extensions.

Let $\DAlg_{k//R}\cn = (\DAlg_k\cn)_{/R}$.
For $M \in \Dsf(R)_{\geq 0}$, we define the space of $k$-linear derivations $R \to M$ as
\[
	\Der_k(R, M) := \Map_{\DAlg_{k//R}\cn}(R, R \oplus M).
\]

\begin{prop}
	The functor $\Der_k(R, -)$ is representable, i.e.\ there exists $\LL_{R/k} \in \Dsf(R)_{\geq 0}$ such that
	\[
		\Der_k(R, -) \simeq \Map_R(\LL_{R/k}, -).
	\]
	Furthermore, this $\LL_{R/k}$ agrees with the previous definition.
\end{prop}

\begin{proof}
	This is mostly an exercise.
	The key idea is that, for $S \to T$ over $R$, we have a fiber sequence
	\[
		\Map_{\DAlg_{k//R}\cn}(S, T) \to \Map_{\DAlg_k\cn}(S, T) \to \Map_{\DAlg_k\cn}(S, R).
	\]
\end{proof}

The following is very useful for computations.

\begin{exer}[Conormal sequence]
	Let $k \to R \to S$ in $\DAlg_k\cn$.
	Then there is a cofiber sequence
	\[
		S \otimes_R \LL_{R/k} \to \LL_{S/k} \to \LL_{S/R}.
	\]
\end{exer}

\begin{ex}
	To compute $\LL_{k[x]/k}$, we consider $k \to k[x] \to k$ and note that
	\[
		k \otimes_{k[x]} \LL_{k[x]/k} \to \LL_{k/k} \to \LL_{k/k[x]}.
	\]
	The first term is $k$ and the second term is $0$, so we get $\LL_{k/k[x]} \simeq k[1]$.
\end{ex}

Here are some useful facts for classical commutative rings:
\begin{itemize}
	\item For $R \in \CAlg_k$, we have $H^0(\LL_{R/k}) \cong \Omega^1_{R/k}$.
	\item For a surjection $R \to S$ in $\CAlg_k$ (with kernel $I$), we have $H_1(\LL_{S/R}) \cong I / I^2$.
\end{itemize}
We can recover some exact sequences in Hartshorne from these together with the above conormal sequence.

\begin{dfn}
	A \emph{square-zero extension} $\tilde{S} \to S$ (of $S$ by $M$) in $\DAlg_k\cn$ is a pullback square
	\[
		\begin{tikzcd}
			\tilde{S} \rar \dar & S \dar["0 \textrm{ derivation}"] \\
			S \rar["\textrm{any derivation}"] & S \oplus M[1]
		\end{tikzcd}
	\]
\end{dfn}

\begin{ex}
	We can construct $\ZZ / p^2$ as a square-zero extension
	\[
		\begin{tikzcd}
			\ZZ / p^2 \rar \dar & \FF_p \dar \\
			\FF_p \rar & \FF_p \oplus \FF_p [1]
		\end{tikzcd}
	\]
	in $\DAlg_\ZZ\cn$.
	The derivation here is $d: \FF_p \to (\FF_p)[1]$ constructed from a map $\LL_{\FF_p/\ZZ} \simeq \FF_p[1] \to \FF_p[1]$ induced by multiplication by an element of $\FF_p^\times$.
\end{ex}

\begin{ex}
	If $R \in \DAlg_k\cn$, then
	\[
		\begin{tikzcd}
			\tau_{\leq n} R \rar \dar & \tau_{\leq n - 1} R \dar \\
			\tau_{\leq n - 1} R \rar & \tau_{\leq n - 1} R \oplus H_n(R)[n+1]
		\end{tikzcd}
	\]
	is a square-zero extension.
\end{ex}

\begin{prop}
	If $\tilde{S}$ is a square-zero extension of $S$ by $M \in \Dsf(S)_{\geq 0}$, then $\Map_{\DAlg_{k//S}\cn}(R, \tilde{S})$ is a $\Der_k(R, M)$-torsor.
	The obstruction to a lift existing is in $\Map_R(\LL_{R/k}, M[1])$.
\end{prop}

\section{Lecture 16, 7/6 (D. Arinkin) -- Working with (Compactly Generated) DG-Categories}

Last time, we defined
\[
	\QCoh(X) = \lim_{\Spec R \to X} \Dsf(R).
\]
If $X$ quasicompact and separated, then:
$\Perf(X) = \QCoh(X)^c$, where $\Perf(X)$ is defined locally, i.e.\
\[
\Perf(X) = \lim_{\Spec R \to X} \Perf(R).
\]
By the theorem of Thomason-Trobaugh, $\Perf(X)$ generates $\QCoh(X)$.
The key step in the proof of this theorem is that, if $X = U \cup V$ with $V$ affine, then we can (partially) extend from $\Perf(U)$ to $\Perf(X)$.\footnote{This is the actual TT theorem, and the claim about compact generation is really a corollary of this.}
Really, we can't extend in general due to $K$-theoretic obstructions, but we can extend up to taking direct summands.
More precisely, every $\Fc \in \Perf(U)$ is a direct summand of some $\tilde{F}|_U$ where $\tilde{F} \in \Perf(X)$.

\subsection{Representability and adjoint functor theorems}

Let $\Bsf = \Ind(\Asf) = \Dsf(\Asf\op)$ be compactly generated.
Then $\Bsf$ has products (and all limits) computed pointwise on $\Asf$.
We can view $\Bsf = \Fun(\Asf\op, \Dsf(k))$.

\begin{prop}[Brown representability theorem]
	A functor $\phi: \Bsf\op \to \Dsf(k)$ is representable if and only if $\phi$ sends direct sums in $\Bsf$ to direct products in $k$.
\end{prop}

\begin{proof}
	The forward direction is not hard.
	For the backward direction, use the fact that $\phi$ is determined by $\phi|_{\Asf\op}$.
	(The result is then clear from the construction of $\Bsf$.)
\end{proof}

\begin{cor}
	If $\Bsf_1$ is compactly generated and $\Bsf_2$ is cocomplete, then any continuous functor $F: \Bsf_1 \to \Bsf_2$ has a right adjoint $F^R$.
\end{cor}

\begin{proof}
	For $x \in \Bsf_2$, the functor $\Hom(F(-), x): \Bsf_1\op \to \Dsf(k)$ is representable (by $F^R(x)$).
\end{proof}

\begin{rmk}
	Note that $F^R$ need not be continuous.
	In fact, $F^R$ is continuous if and only if $F(\Bsf_1^c) \subset \Bsf_2^c$ (since we can probe direct sums using compact generators of $\Bsf_1$).
	In this case, $F(\Bsf_1^c)$ generates $\Bsf_2$ if and only if $F^R$ is conservative (i.e.\ $F^R(x) \simeq 0$ implies $x \simeq 0$).
\end{rmk}

\subsection{Quotients}

The following proposition is valid for DG-categories or triangulated categories (though we prefer the former language).

\begin{prop}
	Let $\Bsf$ be a pretriangulated DG-category and $i: \Asf \hookrightarrow \Bsf$ the inclusion of a full subcategory.
	The following are equivalent:
	\begin{enumerate}
		\item $i$ admits a right adjoint $i^R$.
		\item There exists a full subcategory $\Csf \subset \Bsf$ such that:
			\begin{enumerate}
				\item $\Asf \perp \Csf$ (i.e.\ $\Hom(\Asf, \Csf) = 0$), and 
				\item Every $b \in \Bsf$ fits into an exact triangle
				\[
					a \to b \to c \to a[1]
				\]
				with $a \in \Asf$ and $c \in \Csf$.
			\end{enumerate}
	\end{enumerate}
\end{prop}

The proof is a nice exercise, and the following properties may give some hints for the construction of $i^R$.

\begin{enumerate}
	\item The triangle appearing in the Proposition is unique.
	\item $\Asf = {}^\perp \Csf$ and $\Csf = \Asf^\perp$.
	\item For $i^R$, the unit $\id_\Asf \to i^R \circ i$ is an isomorphism (because $i$ is fully faithful).
	\item $\Csf = \ker(i^R)$ (i.e.\ the subcategory mapped by $i^R$ to $0$).
	\item We can identify $\Asf \simeq \Bsf / \Csf$ via $i^R$ (and also $\Bsf / \Asf \simeq \Csf$).
\end{enumerate}

The above provides a ``short exact sequence of DG-categories''
\[
	\Asf \leftrightarrows \Bsf \leftrightarrows \Csf.
\]
We can call $\Csf$ a \emph{localization of $\Bsf$} and $\Asf$ a \emph{colocalization of $\Bsf$}.

\begin{ex}
	For a DG-category $\Asf$, we have a decomposition of $\Csf(\Asf)$ into $\Csf(\Asf)\sfr$ and $\Csf(\Asf)\acy$.
	This gives a short exact sequence
	\[
		\Csf(\Asf)\sfr \leftrightarrows \Csf(\Asf) \leftrightarrows \Csf(\Asf)\acy,
	\]
	explaining why $\Csf(\Asf)\sfr \simeq \Dsf(\Asf)$.
\end{ex}

Now suppose $\Bsf$ is cocomplete and $\Asf$ is generated by some collection of compact objects $\Asf^c \subset \Bsf^c$.
Then $\Asf \hookrightarrow \Bsf$ has a continuous right adjoint (by our above adjoint functor theorem).
Setting $\Csf = \Asf^\perp$ gives a short exact sequence
\[
	\Asf \leftrightarrows \Bsf \leftrightarrows \Csf.
\]
As $\Csf$ is closed under infinite direct sums (because $\Asf$ is compactly generated), all four functors in this short exact sequence preserve infinite direct sums.

As an application, we see that the following notions of ``compact generation'' are equivalent:
\begin{enumerate}
	\item $\Csf = 0$.
	\item $(\Asf^c)^\perp = 0$.
	\item $\Ind(\Asf^c) = \Bsf$.
\end{enumerate}

Now suppose furthermore that $\Bsf$ is compactly generated.
Then:
\begin{enumerate}
	\item The natural map $p: \Bsf \to \Csf$ preserves compact objects, so its right adjoint is continuous.
	\item The image $p(\Bsf^c)$ generates $\Csf$ (because the right adjoint $\Csf \to \Bsf$ is conservative).
	\item In particular, $\Csf$ is compactly generated, and $\Csf^c = (p(\Bsf^c)\pretr)\Kar = \Perf(p(\Bsf^c)\op)$.
\end{enumerate}

\begin{ex}
	Let $X = \Spec R$, and let $Y \subset X$ be closed such that $U = X \setminus Y$ is quasicompact (equivalently, $Y = V(f_1, \dots, f_n)$ as a set).
	Note that $\QCoh(X) = \Ind(\Oc_X) = \Dsf(R)$.
	Consider the full subcategory $\QCoh(X)_Y$ of quasicoherent sheaves supported on $Y$, which we can also write as
	\[
		\QCoh(X)_Y = \Ind(\otimes_{i=1}^n (\Oc_X \xrightarrow{f_i} \Oc_X))
	\]
	If $j: U \to X$ is the inclusion, then the right orthogonal to $\QCoh(X)_Y$ is $j_* \QCoh(U)$.
	It follows that $j_* \QCoh(U) = \Ind(\Oc_U)$ is compactly generated.
	(Note that $U$ is only quasi-affine in general, and $\Oc_U$ will in general have nontrivial derived endomorphisms.)
	The Thomason-Trobaugh theorem is essentially telling us that, instead of viewing $j_* \QCoh(U)$ as $(j_* j^*(\Perf(X))\pretr)\Kar$, we can instead drop the ``pre-triangulated completion'' part and only consider the Karoubi completion.
\end{ex}

\begin{exer}
	Suppose we have a short exact sequence of DG-categories
	\[
		\Asf \leftrightarrows \Bsf \leftrightarrows \Csf.
	\]
	If $\{ G_\beta \} \subset \Asf^c$ generate $\Asf$ and $\{ F_\alpha \} \subset \Bsf^c$ are such that $\{ p(F_\alpha) \}$ generate $\Csf$, then $\{ F_\alpha \} \cup \{ G_\beta \}$ generate $\Bsf$.
\end{exer}

\section{Lecture 17, 7/7 (B. Antieau) -- Examples of $n$-Stacks}

\subsection{The cotangent complex of stacks}

Let $X \to Y$ be a map in $\Stk_k$.
For any $x: \Spec R \to X$ and $M \in \Dsf(R)_{\geq 0}$, let
\[
	\Der_{X/Y}(x, M) = \fib\left(X(R \oplus M) \to X(R) \times_{Y(R)} Y(R \oplus M)\right).
\]

\begin{dfn}
	An object $\LL \in \Dsf(X) = \lim_{\Spec S \to X} \Dsf(S)$ is a cotangent complex for $X \to Y$ if there is a natural equivalence
	\[
		\Der_{X/Y}(x, M) \simeq \Map_R(x^* \LL, M)
	\]
	for all $x: \Spec R \to X$.\footnote{In principle there could be multiple such $\LL$, as we are asking $\LL$ to be an object of $\Dsf(X)$ but only probing with connective objects.
	For geometric stacks, this will not be an issue.}
	If $\LL$ is unique, we write $\LL_{X/Y} = \LL$.
\end{dfn}

\begin{ex}
	Considering
	\[
		\pt \xrightarrow{i} B \GL_1 \xrightarrow{p} \pt,
	\]
	we get $i^* \LL_p[1] \simeq \LL_i \simeq k[0]$ and therefore $i^* \LL_p \simeq k[-1]$.
	This is generalized in a problem in the exercises.\footnote{The statement of the exercise is missing a shift.}
\end{ex}

In general, if the cotangent complex is concentrated in cohomological degree $\leq n$, then we expect that our map is a relative $n$-stack.

\subsection{Moduli of objects}

Define a derived prestack $\ul{\Perf}$ by
\[
	\ul{\Perf}(R) = \iota(\Perf(R)) = \iota(\Dsf(R)^c).
\]
Here $\iota$ is the underlying $\infty$-groupoid functor (i.e.\ $\iota(\Csf)$ forgets all non-identity equivalences in $\Csf$).

\begin{ex}
	For $R = \ZZ$, we have 
	\[
		\iota(\Perf(\ZZ)) = \coprod_{n \geq 0} B \GL_n(\ZZ).
	\]
\end{ex}

\begin{thm}
	The prestack $\ul{\Perf}$ is a derived stack (i.e.\ it satisfies \'etale or fppf descent).
\end{thm}

\begin{proof}
	The idea is faithfully flat descent: if $R \to S$ is a faithfully flat morphism and $S^\bullet$ is the \v{C}ech complex of $S$ over $R$, then we have
	\[
		\Dsf(R) \simeq \Tot(\Dsf(S^\bullet)).
	\]
	We obtain $\Perf(R) \hookrightarrow \Tot(\Perf(S^\bullet))$, and we need to show that this is essentially surjective.

	To prove essential surjectivity, note that we can pull back any object of $\Tot(\Perf(S^\bullet))$ to an object $M \in \Dsf(R)$.
	This object $M$ is dualizable (since dualizablility can be checked locally and holds on $S^\bullet$).\footnote{Here we are using crucially that $R$ is commutative.}
	Since dualizability in $\Dsf(R)$ is equivalent to perfectness, we get $M \in \Perf(R)$.
\end{proof}

We will use $\ul{\Perf}$ to construct many examples of geometric derived stacks.

\subsection{$\Tor$-amplitude}

\begin{dfn}
	An object $M \in \Dsf(R)$ has $\Tor$-amplitude in $[a, b]$ if for any $N \in \Mod_{\pi_0 R}$, we have
	\[
		H_i(M \otimes^\Lbf_R N) = 0 \hspace{2em} \forall i \not\in [a, b].
	\]
\end{dfn}

\begin{ex}
	The ring $R$, viewed as a module over itself, has $\Tor$-amplitude in $[0, 0]$.
\end{ex}

\begin{ex}
	If we have a cofiber sequence
	\[
		R \xrightarrow[f] R \to M,
	\]
	then $M$ has $\Tor$-amplitude in $[0, 1]$.
\end{ex}

Let $\ul{\Perf}_{[a,b]}$ be the substack of $\Perf$ classifying objects with $\Tor$-amplitude in $[a, b]$.

\begin{thm}[To\"en-Vaqui\'e]
	The derived stack $\ul{\Perf}$ is locally an $n$-stack, and we can write $\ul{\Perf} = \cup_n \ul{\Perf}_{[-n, n]}$.
	Furthermore, each $\ul{\Perf}_{[a,b]}$ is a $(b - a + 1)$-stack which is locally of finite presentation.
\end{thm}

Here are some key facts about $\Tor$-amplitude.

\begin{enumerate}
	\item $\Perf_{[0,0]}(R) = \Proj_R^c$ (consisting of compact projective $R$-modules) and $\Ho(\Perf_{[0,0]}(R)) = \Proj_{\pi_0 R}^{\mathrm{fp}}$.
	\item If $P \in \Perf(R)$, then $P$ has $\Tor$-amplitude in $[a,b]$ for some $a, b \in \ZZ$.
	\item If $P \in \Perf_{[a,b]}(R)$, then $H_a(P)$ is finitely presented as a $(\pi_0 R)$-module.
	\item If $P$ has $\Tor$-amplitude in $[a, b]$ with $a < b$, then there exists a map $R^I[a] \to P$ which is surjective on $H_0$, and the cofiber $Q$ of this map has $\Tor$-amplitude in $[a+1, b]$.
	\item If $P$ has $\Tor$-amplitude in $[a, b]$, then its $R$-linear dual has $\Tor$-amplitude in $[-b, -a]$.
\end{enumerate}

With these facts, we can now discuss the proof of the Theorem.

\begin{proof}
	Proceed by induction on $n = b - a$.
	Note that $\ul{\Perf}_{[a,b]} \simeq \ul{\Perf}_{[0,n]}$, so it suffices to consider the latter.

	For the base case ($n = 0$), $\ul{\Perf}_{0,0}$ is the moduli of projectives of $R$.
	We have a natural map $\ul{B \GL_N} \to \ul{\Perf}_{[0,0]}$.
	This map is surjective because, Zariski-locally, any projective is free.
	Furthermore, the map is fully faithful, hence is an equivalence of stacks.

	Thus it suffices to show that $B \GL_N$ is a $1$-stack locally of finite presentation.
	To achieve this, we show that $\pt \to \ul{B \GL_n}$ is a smooth relative $0$-stack.
	This follows from the fact that $\GL_n$ is a smooth $0$-stack (which in turn follows from the open embedding $\GL_N(R) \subset \End(R^N) \simeq R^{N^2}$, i.e.\ $\ul{\GL}_N \subset (\Omega^\infty \Oc)^{N^2}$, as the complement of $\det = 0$).

	For the inductive step, we assume that $\ul{\Perf}_{[1,n]}$ is an $n$-stack.
	Consider the pullback in $\Stk_k$:
	\[
		\begin{tikzcd}
			U \rar \dar & \iota \Fun(\Delta^1, \Perf(-)) \dar \\
			\ul{\Perf}_{[1,n]} \times_{\Spec k} \ul{\Perf}_{1,1} \rar & \ul{\Perf}^{\partial \Delta^1}.
		\end{tikzcd}
	\]
	The object in the lower left corner of the pullback square is an $n$-stack.
	We can view $U$ as the stack of maps $f: Q \to R^N[1]$ for $Q \in \Perf_{1,N}(R)$.
	There is a natural map $U \to \ul{\Perf}_{[0,n]}$ given by $f \mapsto \fib(f)$.
	Every object of $\ul{\Perf}_{[0,n]}$ fits into a truncation fiber sequence, showing that this map is surjective.

	Thus it suffices to show that $U$ is an $n$-stack (locally of finite presentation) and that $U \to \ul{\Perf}_{[0,n]}$ is a smooth surjective relative $n$-stack.
	We will prove the former claim and omit the latter (which is similar) for time.
	Consider a pullback diagram
	\[
		\begin{tikzcd}
			P \rar \dar & \Spec R \dar["(Q, R^N[1])"] \\
			U \rar & \ul{\Perf}_{[1,n]} \times \ul{\Perf}_{[1,1]}.
		\end{tikzcd}
	\]
	Here $P$ is the ``stack of arrows $Q \to R^N[1]$.''
	More precisely,
	\[
		P(S) \simeq \Map_{\Dsf(S)_{\geq 0}(Q)}(S \otimes_R Q, S^N[1]) \simeq \Map_{\Dsf(S)_{\geq 0}}((Q \otimes R^N[-1]) \otimes_R S, S).
	\]
	(Note that, since $Q \in \Dsf(R)_{\geq 1}$, we have $Q \otimes R^N[-1] \in \Dsf(R)_{\geq 0}$.)
	Further rewriting, we get
	\[
		P(S) \simeq \Map_{\Dsf(R)_{\geq 0}}(Q \otimes R^N[-1], S) \simeq \Map_{\DAlg_R\cn}(\Lbf \Sym_R (Q \otimes R^N[-1]), S).
	\]
	Thus $P \simeq \Spec \Lbf \Sym_R (Q \otimes_R R^N[-1])$.
	It follows that $U$ is an $n$-stack.

	For the omitted part of the proof, argue similarly.
	The fibers $P' = U \times_{\ul{\Perf}_{[0,n]}} \Spec R$ can be written as
	\[
		P' \simeq \coprod_N \left\{ P \to Q \to R^N[1] \right\} \simeq \coprod_N \left\{ R^N \to P \textrm{surjective on $\pi_0$}\right\}.
	\]
	This is an open substack of $\{ R^N \to P \} \simeq \Spec \Lbf \Sym_R (R^N \otimes_R P^\vee)$.
	A crucial problem is that $\Lbf \Sym_R (R^N \otimes_R P^\vee)$ is not connective, so we are not guaranteed that this is a stack.
	We can fix this by noting that
	\[
		\Spec \Lbf \Sym_k k[-r] := \Map_{\DAlg_k}(\Lbf \Sym_k k[-r], -) \simeq B^r \Omega^\infty \Oc
	\]
	using the defining adjunction of $\Lbf \Sym_k$.
	This lets us make sense of things.
\end{proof}

\subsection{$\ul{\Rep}_A$}

Let $A$ be a $k$-linear DGA.
We define a stack $\ul{\Rep}_A$ by
\[
	\ul{\Rep}_A(R) = \iota \Mod_{R \otimes_k A}(\Perf(R)).
\]

\begin{thm}[To\"en-Vaqui\'e]
	If $A$ is compact as a DGA, then $\ul{\Rep}_A$ is locally geometric.
\end{thm}

The idea is to look at the fibers of $\ul{\Rep}_A \to \ul{\Perf}$.
One argues similarly to above, but also using the fact that every compact DGA can be presented using free ones.

\begin{lem}
	At an $R$-point $P: \Spec R \to \ul{\Rep}_A$, the cotangent complex is
	\[
		\Map_{R \otimes_k A}^{\textrm{dg}}(P, P)^\vee[-1].
	\]
\end{lem}

\subsection{$\ul{\Mf}_X$ and $\ul{\Pic}_{X/k}$}

Let $X$ be smooth and proper over $k$.
Then $\Dsf^b(X) \simeq \Perf(A)$ for some compact DGA $A$.
We define $\ul{\Mf}_X = \ul{\Rep}_A$, so $\ul{\Mf}_X(R) = \iota \Perf(X_R)$.
General moduli spaces of sheaves will be substacks of $\ul{\Mf}_X$.

Let $\ul{\Pic}_X$ be the open substack of $\ul{\Mf}_X$ classifying $\otimes$-invertible objects in $\Dsf(X_R)$.
For $\Lc \in \ul{\Pic}_{X/k}(k)$, we have
\[
	\LL_\Lc \simeq \Map_X^{\textrm{dg}}(\Lc, \Lc)^\vee[-1] \simeq \Map_X^{\textrm{dg}}(\Oc_X, \Oc_X)^\vee[-1] \simeq \Rbf \Gamma(X, \Oc_X)^\vee[-1].
\]

Avramov's theorem tells us that the cotangent complex of a classical Artin stack either:
\begin{enumerate}
	\item Has $\Tor$-amplitude in $[0, 0]$ (the smooth case),
	\item Has $\Tor$-amplitude in $[0, 1]$ (the LCI case), or
	\item Is unbounded.
\end{enumerate}
Thus, if $H^i(X, \Oc_X) \neq 0$ for some $i > 2$, then $\ul{\Pic}_{X/k}$ is non-classical.

\section{Lecture 18, 7/7 (D. Arinkin) -- Operations on DG-Categories and Geometry}

Last time, we discussed quotients of DG-categories.
In the ``large'' (cocomplete) context, we get short exact sequences with adjunctions
\[
	\Asf \leftrightarrow \Bsf \leftrightarrow \Csf.
\]
Working with ``small'' DG-categories (e.g.\ DG-categories of compact objects), the functors in the short exact sequences typically do not admit adjoints, and we only get
\[
	\Asf^c \to \Bsf^c \to \Csf^c.
\]
The Thomason-Trobaugh theorem measures the surjectivity of $\Bsf \to \Csf$ in some geometric cases.

\subsection{Tensor products}

For small DG-categories $\Asf$ and $\Bsf$, we define the tensor product $\Asf \otimes \Bsf$ by
\begin{enumerate}
	\item $\Ob(\Asf \otimes \Bsf) = \Ob \Asf \times \Ob \Bsf$
	\item $\Hom_{\Asf \otimes \Bsf}(a_1 \otimes b_1, a_2 \otimes b_2) = \Hom_\Asf(a_1, a_2) \otimes \Hom_\Bsf(b_1, b_2)$.
\end{enumerate}
One can also characterize this in terms of universal properties.

This definition works well for arbitrary DG-categories.
If we want to restrict to pre-triangulated / Karoubian / ... DG-categories, we take the tensor product as above and then take the pre-triangulated / Karoubian / ... completion of the result.

For ``large'' DG-categories, we want a tensor product of cocomplete DG-categories satisfying
\[
	\Ind(\Asf) \otimes\cc \Ind(\Bsf) = \Ind(\Asf \otimes \Bsf).
\]
Note here that we are using two different notions of $\otimes$.\footnote{I am using the notation $\otimes\cc$ to keep the ideas separate, though this was not used in the lecture.}
In general, the tensor product of cocomplete DG-categories is defined by a universal property using continuous bilinear functors.

More precisely, starting from cocomplete DG-categories $\Asf$ and $\Bsf$, we construct the cocomplete tensor product $\Asf \otimes\cc \Bsf$ as a quotient of $\Ind(\Asf \otimes \Bsf)$ by objects of the forms
\[
	\cone\left(\oplus_{\alpha} (a_\alpha \otimes b) \to (\oplus a_\alpha) \otimes b\right)
\]
and
\[
	\cone\left(\oplus_{\alpha} (a \otimes b_\alpha) \to a \otimes (\oplus b_\alpha)\right)
\]

\subsection{Duals}

For ``small'' DG-categories, we can define duals using opposite categories: the dual of $\Asf$ is $\Asf\op$.
For ``large'' DG-categories, we would like to have a notion of dual satisfying $(\Ind(\Asf))^\vee = \Ind(\Asf\op)$. 
Note that
\[
	\Ind(\Asf\op) = \Dsf(\Asf) = \Fun(\Asf, \Dsf(k)) = \Fun(\Ind(\Asf), \Dsf(k))\cont,
\]
so we can use this to define $(\Ind(\Asf))^\vee$.

In general, we can use the tensor product of cocomplete DG-categories to define a notion of dualizability.
All compactly generated DG-categories are dualizable, and the above construction gives the dual.
Duals of other DG-categories may not exist.

\subsection{Geometry}

Let $X$ be a quasicompact separated scheme.
Recall that $\QCoh(X) = \Ind \Perf X$ is compactly generated, in fact by a single object (by the proof of Thomason-Trobaugh).
It follows that $\QCoh(X)^\vee = \Ind(\Perf(X)\op)$.

\begin{ex}
	If $X = \Spec R$ is affine, then $\QCoh(X) = \Dsf(R)$ and $\QCoh(X)^\vee = \Dsf(R\op)$.
	Since $R$ is commutative, we get a natural identification $\QCoh(X) \simeq \QCoh(X)^\vee$.
\end{ex}

More generally, we have an antiequivalence $\Perf(X)\op \tilde{\to} \Perf(X)$ given by $\scHom(-,\Oc_X)$, the ordinary dual.\footnote{In this case, Grothendieck / Serre duality is not as well behaved, e.g.\ $\omega_X$ may not be perfect.}
Therefore $\QCoh(X) \simeq \QCoh(X)^\vee$.
This identification corresponds to a functor $\QCoh(X) \times \QCoh(X) \to \Dsf(k)$, but how do we identify this functor?
The functor arises as an $\Ind$-extension of $\Hom(-,-): \Perf(X)\op \times \Perf(X) \to \Dsf(k)$.
Using our antiequivalence, we see that the functor $\QCoh(X) \times \QCoh(X) \to \Dsf(k)$ is given by
\[
	(\Fc, \Gc) \mapsto \Gamma(X, \Fc \otimes \Gc).
\]
One can view this as categorifying the duality pairing of functional analysis: $(f, g) \mapsto \int_X fg d\mu$.

If $X$ and $Y$ are both quasicompact separated schemes, then
\[
	\QCoh(X) \otimes \QCoh(Y) = \Ind(\Perf(X) \otimes \Perf(Y)).
\]
We claim that this is equivalent to $\QCoh(X \times Y) = \Ind(\Perf(X \times Y))$.
For affine schemes, this is easy.

More generally, consider the functor $\Perf(X) \otimes \Perf(Y) \to \Perf(X \times Y)$ given by $(\Fc, \Gc) \mapsto \Fc \boxtimes \Gc$.
One can show this is fully faithful (since $\Perf(-)$ is defined as a limit, and we can compute $\Hom$ in limit DG-categories easily).
One then shows that the image generates $\QCoh(X \times Y)$, i.e.\ that the right orthogonal $(\Perf(X) \otimes \Perf(Y))^\perp$ vanishes.
Thus we obtain the desired equivalence.

\begin{cor}
	\[
		\Fun(\QCoh(X), \QCoh(Y))\cont \simeq \QCoh(X \times Y).
	\]
\end{cor}

\begin{proof}
	One can reduce to the case of ``small'' DG-categories:
	\begin{align*}
		\Fun(\QCoh(X), \QCoh(Y))\cont &\simeq \Fun(\Dsf(\Perf(X)\op), \Dsf(\Perf(Y)\op))\cont \\
		&\simeq \Dsf(\Perf(X) \otimes \Perf(Y)\op) \\
		&\simeq \Dsf(\Perf(X \times Y)\op)
		&\simeq \QCoh(X \times Y).
	\end{align*}

	Alternatively, one can use dualizability to write 
	\[
		\Fun(\QCoh(X), \QCoh(Y))\cont \simeq \QCoh(X)^\vee \otimes \QCoh(Y) \simeq \QCoh(X \times Y).
	\]
\end{proof}

To use this equivalence, we would like to make things more explicit.
Given $\Kc \in \QCoh(X \times Y)$, the corresponding functor is the Fourier-Mukai transform
\[
	\Phi_\Kc(-) = p_{Y*} (p_X^*(-) \otimes \Kc).
\]
Note that this is an equivalence of DG-categories, so morphisms in $\QCoh(X \times Y)$ correspond to natural transformations of functors, etc.

\begin{ex}
	Consider the identity functor $\id_{\QCoh(X)} \in \Fun(\QCoh(X), \QCoh(X))\cont$.
	Under the above equivalence, this corresponds to the sheaf $\Oc_\Delta \in \QCoh(X \times X)$.
	Therefore
	\[
		\Ext^\bullet(\id_{\QCoh(X)}, \id_{\QCoh(X)}) = \Ext^\bullet_{X \times X}(\Oc_\Delta, \Oc_\Delta).
	\]
	This computes the \emph{Hochschild cohomology} of $X$.
\end{ex}

We can ask several further interesting questions.
Given a morphism $X \to Y$, we may view $\QCoh(Y)$ as a commutative algebra via its internal tensor product.
Then $\QCoh(X)$ is a module over $(\QCoh(Y), \otimes)$.
We can study properties of such modules and / or try to classify and understand modules over $(\QCoh(Y), \otimes)$.

Unfortunately, with all of this freedom, it can be hard to formalize everything that's happening.
For example, we have isomorphisms for associativity, base change, projection formulas, etc.
How do we tell whether these isomorphisms are compatible?
It turns out to be hopeless to write these explicitly, so it's better to use indirect approaches.
The book of Gaitsgory-Rozenblyum aims to set things up properly so that everything that ``\emph{should}'' work \emph{does}.

\end{document}
